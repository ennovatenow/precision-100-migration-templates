TRUNCATE TABLE TF001_RISK;

commit;

---------------OUTWARD BANK GUARANTEE---------------
INSERT INTO TF001_RISK
select 
--BGFUNCCODE
CASE WHEN B.REFNO_PFIX='CRE' THEN 'A'
     WHEN B.REFNO_PFIX='AMD' THEN 'U' END BGFUNCCODE, 
--BGSOLID
'900' BGSOLID,--SOL.FIN_SOL_ID BGSOLID, 
--BGSRLNUM
REPLACE(SUBSTR(M.MASTER_REF,1,16),'/','-') BGSRLNUM, 
--EVENTAMT
ABS(B.AMOUNT)/C8.C8PWD  EVENTAMT, 
--BGEXPIRYMONTHS
'' BGEXPIRYMONTHS, 
--BGEXPIRYDAYS
'' BGEXPIRYDAYS, 
--BGEXPIRYDATE
TO_CHAR(M.EXPIRY_DAT,'DD-MM-YYYY') BGEXPIRYDATE,
--BGCLAIMEXPIRYMONTHS
'' BGCLAIMEXPIRYMONTHS, 
--BGCLAIMEXPIRYDAYS
'' BGCLAIMEXPIRYDAYS, 
--BGCLAIMEXPIRYDATE
TO_CHAR(M.EXPIRY_DAT,'DD-MM-YYYY') BGCLAIMEXPIRYDATE,
--BGCHARGEBORNEBY
'' BGCHARGEBORNEBY, 
--BGTYPE
CASE WHEN TRIM(B.REFNO_PFIX)='AMD' THEN NULL ELSE  
     CASE WHEN PR.CODE='BLG' THEN 'RPLG'
          WHEN PR.CODE='BLC' THEN 'RPLC'
     END
END BGTYPE,
--BGCRITCRNCY
M.CCY BGCRITCRNCY, 
--BGAPPLCIFID
PCPM.FIN_CIF_ID BGAPPLCIFID, 
--EVENTDATE
TO_CHAR(B.FINISHED,'DD-MM-YYYY') EVENTDATE,  ---TO_CHAR(B.FINISHED,'DD-MM-YYYY')
--BGPURPOSE 
'' BGPURPOSE,
--BGCLASS
'' BGCLASS, 
--BGEFFECTIVEDATE 
TO_CHAR(B.FINISHED,'DD-MM-YYYY') BGEFFECTIVEDATE,
--BGAPPLICABLERULES
'NONE' BGAPPLICABLERULES, 
--BGAPPLICABLESUBRULES
'' BGAPPLICABLESUBRULES, 
--BGFRUCTLIABAMT
'' BGFRUCTLIABAMT, 
--ISORGBGRECEIVED 
'' ISORGBGRECEIVED,
--BGREMARKS
'SHARE '||TRIM(BEN.LIAB_PCT) ||'%'||' REVOLVING '||PTN.REVOLVING BGREMARKS,  ---||'- AMOUNT '|| trim(to_char(BEN.LIAB_AMT/c8.c8pwd,'99999999999999.999')) ||'- '|| TRIM(BEN.LIAB_CCY),1,100) ---REMOVED AS DISCUSSED WITH KAHIL SIR 26-03-2017
--COUNTERBGNUM 
'' COUNTERBGNUM,
--IMPLICENSENO
'' IMPLICENSENO, 
--IMPLICENSEEXPDATE
'' IMPLICENSEEXPDATE, 
--CAPADQCODE
'' CAPADQCODE, 
--PROVISIONAMT
'' PROVISIONAMT, 
--FREECODE1
CASE WHEN TRIM(WORKGROUP)='SBLCMU' THEN 'SBLCM'
     WHEN TRIM(WORKGROUP)='UANNUL' THEN 'UANNL'
     WHEN TRIM(WORKGROUP)='UHALFY' THEN 'UHLFY'
     WHEN TRIM(WORKGROUP)='UQUART' THEN 'UQURT'
ELSE TRIM(WORKGROUP) END FREECODE1, 
--FREECODE2 
'' FREECODE2,
--FREECODE3 
'' FREECODE3,
--APPLOPERACCT
--CASE WHEN TRIM(OP.FIN_ACC_NUM) IS NOT NULL THEN OP.FIN_ACC_NUM ELSE '0050129220000' END APPLOPERACCT, -- CHANGE AS PER SEBI'S MAIL AS OF 11-10-2017
CASE WHEN TRIM(OP.FIN_ACC_NUM) IS NOT NULL THEN OP.FIN_ACC_NUM ELSE '900'||CN.CRNCY_ALIAS_NUM||'48103100' END APPLOPERACCT,
--APPLPARTYNAME
CASE WHEN TRIM(PCP.ADDRESS1) IS NOT NULL THEN TRIM(PCP.ADDRESS1) ELSE '.' END APPLPARTYNAME, 
--APPLPARTYADDR1
PCP.ADDRESS2 APPLPARTYADDR1, 
--APPLPARTYADDR2
PCP.ADDRESS3 APPLPARTYADDR2, 
--APPLPARTYADDR3
SUBSTR(TRIM(TRIM(PCP.ADDRESS4)||' '||TRIM(PCP.ADDRESS5)),1,40) APPLPARTYADDR3, 
--APPLPARTYCITY 
'' APPLPARTYCITY,
--APPLPARTYSTATE
'' APPLPARTYSTATE, 
--APPLPARTYCNTRY
PCP.COUNTRY APPLPARTYCNTRY, 
--APPLPARTYPINCODE
TRIM(PCP.ZIPCODE) APPLPARTYPINCODE, 
--APPLREFNUM
SUBSTR(TRIM(PCP.REFERENCE),1,8) APPLREFNUM, 
--BGRATECODE
'MID' BGRATECODE, 
--BGRATE
'' BGRATE, 
--OTHERBANKREFNUM
SUBSTR(TRIM(B.THEIR_REF),1,16) OTHERBANKREFNUM, --------------------------------------------------?????????????? B.THEIR_REF
--PAYSYSID 
'' PAYSYSID,
--BENCIFID
'' BENCIFID, 
--BENNAME 
BEN.ADDRESS1 BENNAME,
--BENADDR1 
CASE WHEN TRIM(BEN.ADDRESS2) IS NOT NULL THEN BEN.ADDRESS2 ELSE '.' END BENADDR1,
--BENADDR2 
BEN.ADDRESS3 BENADDR2,
--BENADDR3 
TRIM(SUBSTR(TRIM(BEN.ADDRESS4)||' '||TRIM(BEN.ADDRESS5),1,40)) BENADDR3,
--BENCITY 
'' BENCITY,
--BENSTATE
'' BENSTATE, 
--BENCNTRY
BEN.COUNTRY BENCNTRY, 
--BENPINCODE
TRIM(BEN.ZIPCODE) BENPINCODE, 
--BENTYPE 
'O' BENTYPE,
--BGCORRBANKCODE
'' BGCORRBANKCODE, 
--BGCORRBRANCHCODE
'' BGCORRBRANCHCODE, 
--BGCORRBANKNAME 
'' BGCORRBANKNAME,
--BGCORRBANKADDR1 
'' BGCORRBANKADDR1,
--BGCORRBANKADDR2 
'' BGCORRBANKADDR2,
--BGCORRBANKADDR3 
'' BGCORRBANKADDR3,
--BGCORRBANKCITY 
'' BGCORRBANKCITY,
--BGCORRBANKSTATE 
'' BGCORRBANKSTATE,
--BGCORRBANKCNTRY 
'' BGCORRBANKCNTRY,
--BGCORRBANKPINCODE 
'' BGCORRBANKPINCODE,
--BGBICCODE 
'' BGBICCODE,
--PARTYID 
'' PARTYID,
--ADDRTYPE 
'' ADDRTYPE,
--BGCRNCYCODE 
'',
--DCREFNUM
'' DCREFNUM,
--SGBILLEQVCRNCYCODE
CASE WHEN PR.CODE='SHP' THEN TO_CHAR(M.CCY) ELSE '' END SGBILLEQVCRNCYCODE, 
--SGBILLEQVAMT
CASE WHEN PR.CODE='SHP' THEN TO_CHAR(ABS(B.AMOUNT)/C8.C8PWD,'99999999999.999') ELSE '' END SGBILLEQVAMT, 
--BGDCRATECODE
'' BGDCRATECODE, 
--BGDCRATE
'' BGDCRATE, 
--SGCONTCRNCYCODE
'' SGCONTCRNCYCODE, 
--SGCONTAMT
'' SGCONTAMT, 
--SGMINCONTAMT
'' SGMINCONTAMT, 
--SGCONTREVERSALEVENT
CASE WHEN PR.CODE='SHP' THEN 'A' ELSE '' END SGCONTREVERSALEVENT, 
--SGMARGINREVRATECODE
'' SGMARGINREVRATECODE, 
--SGTRUSTRECNUM
'' SGTRUSTRECNUM, 
--NOOFUNITS
'' NOOFUNITS, 
--UNITVALUE
'' UNITVALUE, 
--GOODSORSRVCSDESC
'' GOODSORSRVCSDESC, 
--SGREMARKS 
M.CANNPRNREF SGREMARKS,
--BILLLADINGNUM
'' BILLLADINGNUM, 
--CARRIERID
'' CARRIERID, 
--CARRIERNAME
'' CARRIERNAME, 
--CARRIERADDR1
'' CARRIERADDR1, 
--CARRIERADDR2
'' CARRIERADDR2, 
--CARRIERADDR3
'' CARRIERADDR3, 
--CARRIERCITY
'' CARRIERCITY, 
--CARRIERSTATE
'' CARRIERSTATE, 
--CARRIERCNTRY
'' CARRIERCNTRY, 
--CARRIERPINCODE
'' CARRIERPINCODE, 
--ORDEROFCONSIGNEE
'' ORDEROFCONSIGNEE, 
--PORTOFDESTINATION
'' PORTOFDESTINATION, 
--ACTSHIPMENTDATE 
'' ACTSHIPMENTDATE,
--LIMITPREFIX
'' LIMITPREFIX, 
--LIMITSUFFIX
'' LIMITSUFFIX, 
--LIMITMARGINPCNT
'' LIMITMARGINPCNT, 
--INTERNALLIMITS
'' INTERNALLIMITS, 
--AMENDIND
CASE WHEN B.REFNO_PFIX='AMD' AND B.AMOUNT<0 THEN 'R' 
     WHEN B.REFNO_PFIX='AMD' AND B.AMOUNT>0 THEN 'E'
     ELSE '' END AMENDIND, 
--AMENDREMARKS 
CASE WHEN B.REFNO_PFIX='AMD' THEN TO_CHAR(B.STATUS_EV) ELSE '' END AMENDREMARKS,
--AMENDSTATUS
CASE WHEN B.REFNO_PFIX='AMD' THEN 'A' ELSE '' END AMENDSTATUS, 
--AMENDINITIATEDBY
CASE WHEN B.REFNO_PFIX='AMD' THEN 'A' ELSE '' END AMENDINITIATEDBY, 
--AUTORENEWAPPLICABLEFLG
'N' AUTORENEWAPPLICABLEFLG,--CASE WHEN TRIM(M.EXPIRY_DAT) IS NULL THEN 'Y' ELSE '' END 
--FINALEXPIRYDATE
'' FINALEXPIRYDATE, --CASE WHEN TRIM(M.EXPIRY_DAT) IS NULL THEN '31-12-2099' ELSE '' END
--AUTORENEWNEXTCYCLE
'' AUTORENEWNEXTCYCLE, --CASE WHEN TRIM(M.EXPIRY_DAT) IS NULL THEN 'Y' ELSE '' END 
--AUTORENEWFREQTYPE
'' AUTORENEWFREQTYPE, --CASE WHEN TRIM(M.EXPIRY_DAT) IS NULL THEN 'H' ELSE '' END 
--AUTORENEWFREQDATE
'' AUTORENEWFREQDATE, --CASE WHEN TRIM(M.EXPIRY_DAT) IS NULL THEN TO_CHAR(TO_DATE(B.START_DATE,'YYYYMMDD'),'DD') ELSE '' END 
--AUTORENEWFREQWEEKNUM 
'' AUTORENEWFREQWEEKNUM,
--AUTORENEWFREQDAY
'' AUTORENEWFREQDAY, 
--ISFREQDAYONHOLIDAY
'' ISFREQDAYONHOLIDAY, --CASE WHEN TRIM(M.EXPIRY_DAT) IS NULL THEN 'N' ELSE '' END 
--BGCOUNTERGUARANTEERATECODE
'' BGCOUNTERGUARANTEERATECODE,
--COUNTERRATE
'' COUNTERRATE, 
--ADVANCEAMTPAID
'' ADVANCEAMTPAID, 
--SOLIDORDER1
'' SOLIDORDER1, 
--ORDERNODTLS1
'' ORDERNODTLS1, 
--SOLIDORDER2
'' SOLIDORDER2, 
--ORDERNODTLS2
'' ORDERNODTLS2, 
--SOLIDORDER3
'' SOLIDORDER3, 
--ORDERNODTLS3
'' ORDERNODTLS3, 
--SOLIDORDER4
'' SOLIDORDER4, 
--ORDERNODTLS4
'' ORDERNODTLS4, 
--SOLIDORDER5
'' SOLIDORDER5, 
--ORDERNODTLS5
'' ORDERNODTLS5, 
--PURCHASEFORACID
'' PURCHASEFORACID, 
--SGDOPAYABLEFORACID
'' SGDOPAYABLEFORACID, 
--EXECADVNO1
'' EXECADVNO1, 
--EXECADVNO2
'' EXECADVNO2, 
--EXECADVNO3
'' EXECADVNO3, 
--EXECADVNO4
'' EXECADVNO4, 
--EXECADVNO5
'' EXECADVNO5, 
--PROMISETOPURCHASERECV
'' PROMISETOPURCHASERECV, 
--PROMISETOPURCHASEDATE
'' PROMISETOPURCHASEDATE, 
--PROMISETOPURCHASEREFNO
'' PROMISETOPURCHASEREFNO, 
--PURCHASEACCPTADVICE
'' PURCHASEACCPTADVICE, 
--FINANCINGFORACID
'' FINANCINGFORACID, 
--DEBITFINANCINGFORACID
'' DEBITFINANCINGFORACID, 
--PREFIXFINANCINGLIMITID
'' PREFIXFINANCINGLIMITID, 
--SUFFIXFINANCINGLIMITID
'' SUFFIXFINANCINGLIMITID, 
--ISLAMICRATECODE
'' ISLAMICRATECODE, 
--ISLAMICRATE
'' ISLAMICRATE, 
--SECTORCODE
'E' SECTORCODE,  
--EXPCIFID
'' EXPCIFID, 
--EXPNAME
'' EXPNAME, 
--EXPADDR1
'' EXPADDR1, 
--EXPADDR2
'' EXPADDR2, 
--EXPADDR3
'' EXPADDR3, 
--EXPCITY
'' EXPCITY, 
--EXPSTATE
'' EXPSTATE, 
--EXPCNTRY
'' EXPCNTRY, 
--EXPPINCODE
'' EXPPINCODE, 
--BGCOLLBANKCODE
'' BGCOLLBANKCODE, 
--BGCOLLBRANCHCODE
'' BGCOLLBRANCHCODE, 
--BGCOLLBANKNAME
'' BGCOLLBANKNAME, 
--BGCOLLBANKADDR1
'' BGCOLLBANKADDR1, 
--BGCOLLBANKADDR2
'' BGCOLLBANKADDR2, 
--BGCOLLBANKADDR3
'' BGCOLLBANKADDR3, 
--BGCOLLBANKCITY
'' BGCOLLBANKCITY, 
--BGCOLLBANKSTATE
'' BGCOLLBANKSTATE, 
--BGCOLLBANKCNTRY
'' BGCOLLBANKCNTRY, 
--BGCOLLBANKPINCODE
'' BGCOLLBANKPINCODE, 
--BGCOLLBICCODE
'' BGCOLLBICCODE,
--BGCOLLPARTYID 
'' BGCOLLPARTYID,
--BGCOLLADDRTYPE
'' BGCOLLADDRTYPE, 
--INTENDTOEXPORT
'' INTENDTOEXPORT, 
--INWARDDCREFNUM
'' INWARDDCREFNUM
FROM MASTER_ODS M
INNER JOIN TF_RISKPART_MASTER RP ON RP.MASTER_REF=M.MASTER_REF
LEFT JOIN PARTPNMSTR_ODS PTN ON M.KEY97=PTN.KEY97
LEFT JOIN BASEEVENT_ODS B ON B.MASTER_KEY=M.KEY97
LEFT JOIN IGMASTER_ODS I ON I.KEY97=M.KEY97
LEFT JOIN PRODTYPE_ODS PR ON TRIM(PR.KEY97)=TRIM(M.PRODTYPE)
LEFT JOIN PARTYDTLS_ODS PCP ON PCP.KEY97=M.PCP_PTY
LEFT JOIN GFPF_ODS PCPG ON TRIM(REPLACE(PCP.CUS_MNM,' ',''))=TRIM(TRIM(REPLACE(PCPG.GFCUS,' ',''))||TRIM(REPLACE(PCPG.GFCLC,' ',''))) --TRIM(PCPG.GFCUS1)=TRIM(PCPP.CUS_MNM)
LEFT JOIN MAP_CIF PCPM ON PCPG.GFCPNC=PCPM.GFCPNC
LEFT JOIN PARTYDTLS_ODS BEN ON BEN.KEY97=M.NPCP_PTY 
LEFT JOIN C8PF C8 ON C8.C8CCY=M.CCY 
LEFT JOIN MAP_SOL SOL ON SOL.BR_CODE=CASE WHEN TRIM(M.BHALF_BRN) IS NOT NULL THEN M.BHALF_BRN ELSE M.INPUT_BRN END
LEFT JOIN USEROPTN_ODS U2 ON U2.KEY29=M.USEROPTN2
LEFT JOIN USEROPTN_ODS U5 ON U5.KEY29=M.USEROPTN5
LEFT JOIN TF_OP_ACC OP ON OP.MASTER_REF=M.MASTER_REF
LEFT JOIN TBAADM.CNC CN ON CN.CRNCY_CODE=M.CCY AND CN.BANK_ID='01'
WHERE B.STATUS='c' 
AND TRIM(B.REFNO_PFIX) IN ('CRE','AMD')
AND M.REFNO_PFIX='PTN' ; --AND TRIM(M.STATUS)='LIV' AND M.LIAB_AMT!=0  AND B.AMOUNT!=0


COMMIT;


UPDATE TF001_RISK SET
FUNC_CODE=rpad(NVL(FUNC_CODE,' '),1,' '),
SOL_ID=rpad(NVL(SOL_ID,' '),8,' '),
BG_NUM=rpad(NVL(BG_NUM,' '),16,' '),
EVENT_AMT=rpad(NVL(EVENT_AMT,' '),17,' '),
BG_EXPIRY_MONTH=rpad(NVL(BG_EXPIRY_MONTH,' '),3,' '),
BG_EXPIRY_DAYS=rpad(NVL(BG_EXPIRY_DAYS,' '),3,' '),
BG_EXPIRY_DATE=RPAD(NVL(BG_EXPIRY_DATE,' '),10,' '),
BG_CLAIM_EXPIRY_MONTHS=rpad(NVL(BG_CLAIM_EXPIRY_MONTHS,' '),3,' '),
BG_CLAIM_EXPIRY_DAYS=rpad(NVL(BG_CLAIM_EXPIRY_DAYS,' '),3,' '),
BG_CLAIM_EXPIRY_DATE=RPAD(NVL(BG_CLAIM_EXPIRY_DATE,' '),10,' '),
BG_CHARGES_BORNE_BY=rpad(NVL(BG_CHARGES_BORNE_BY,' '),1,' '),
BG_TYPE=rpad(NVL(BG_TYPE,' '),5,' '),
BG_CURRENCY=rpad(NVL(BG_CURRENCY,' '),3,' '),
CIF_ID=rpad(NVL(CIF_ID,' '),32,' '),
EVENT_DATE=RPAD(NVL(EVENT_DATE,' '),10,' '),
PURPOSE_OF_GUARANTEE_TEXT=rpad(NVL(PURPOSE_OF_GUARANTEE_TEXT,' '),39,' '),
BG_CLASS=rpad(NVL(BG_CLASS,' '),5,' '),
BG_EFFECTIVE_DATE=RPAD(NVL(BG_EFFECTIVE_DATE,' '),10,' '),
APPLICABLE_RULES=rpad(NVL(APPLICABLE_RULES,' '),36,' '),
APPLICABLE_SUB_RULES=rpad(NVL(APPLICABLE_SUB_RULES,' '),35,' '),
BG_FRUCTIFIED_AMOUNT=rpad(NVL(BG_FRUCTIFIED_AMOUNT,' '),17,' '),
IS_ORIGINAL_BG_RECEIVED_FLAG=rpad(NVL(IS_ORIGINAL_BG_RECEIVED_FLAG,' '),1,' '),
BG_REMARKS=rpad(NVL(BG_REMARKS,' '),100,' '),
COUNTER_BG_NUMBER=rpad(NVL(COUNTER_BG_NUMBER,' '),16,' '),
IMPORT_LICENSE_NUM=rpad(NVL(IMPORT_LICENSE_NUM,' '),15,' '),
LICENSE_EXPIRYDATE=RPAD(NVL(LICENSE_EXPIRYDATE,' '),10,' '),
CAPITALADEQUANCYCODE=rpad(NVL(CAPITALADEQUANCYCODE,' '),5,' '),
BG_PROVISION_AMOUNT=rpad(NVL(BG_PROVISION_AMOUNT,' '),17,' '),
FREE_CODE1=rpad(NVL(FREE_CODE1,' '),8,' '),
FREE_CODE2=rpad(NVL(FREE_CODE2,' '),8,' '),
FREE_CODE3=rpad(NVL(FREE_CODE3,' '),8,' '),
BG_OPERATIVE_ACCOUNT_ID=rpad(NVL(BG_OPERATIVE_ACCOUNT_ID,' '),16,' '),
APPLICANT_NAME=rpad(NVL(APPLICANT_NAME,' '),80,' '),
APPLICANT_ADDRESS1=rpad(NVL(APPLICANT_ADDRESS1,' '),45,' '),
APPLICANT_ADDRESS2=rpad(NVL(APPLICANT_ADDRESS2,' '),45,' '),
APPLICANT_ADDRESS3=rpad(NVL(APPLICANT_ADDRESS3,' '),45,' '),
APPLICANT_CITY=rpad(NVL(APPLICANT_CITY,' '),5,' '),
APPLICANT_STATE=rpad(NVL(APPLICANT_STATE,' '),5,' '),
APPLICANT_COUNTRY=rpad(NVL(APPLICANT_COUNTRY,' '),5,' '),
APPLICANT_PIN_CODE=rpad(NVL(APPLICANT_PIN_CODE,' '),10,' '),
APPLICANT_REF_NUM=rpad(NVL(APPLICANT_REF_NUM,' '),8,' '),
BG_RATE_CODE=rpad(NVL(BG_RATE_CODE,' '),5,' '),
BG_RATE=rpad(NVL(BG_RATE,' '),10,' '),
OTHER_BANK_REF_NUM=rpad(NVL(OTHER_BANK_REF_NUM,' '),16,' '),
PAYSYS_ID=rpad(NVL(PAYSYS_ID,' '),5,' '),
BENEFICIARY_CIF_ID=rpad(NVL(BENEFICIARY_CIF_ID,' '),32,' '),
BENEFICIARY_NAME=rpad(NVL(BENEFICIARY_NAME,' '),80,' '),
BENEFICIARY_ADDRESS1=rpad(NVL(BENEFICIARY_ADDRESS1,' '),40,' '),
BENEFICIARY_ADDRESS2=rpad(NVL(BENEFICIARY_ADDRESS2,' '),40,' '),
BENEFICIARY_ADDRESS3=rpad(NVL(BENEFICIARY_ADDRESS3,' '),40,' '),
BENEFICIARY_CITY=rpad(NVL(BENEFICIARY_CITY,' '),5,' '),
BENEFICIARY_STATE=rpad(NVL(BENEFICIARY_STATE,' '),5,' '),
BENEFICIARY_COUNTRY=rpad(NVL(BENEFICIARY_COUNTRY,' '),5,' '),
BENEFICIARY_PINCODE=rpad(NVL(BENEFICIARY_PINCODE,' '),10,' '),
BENEFICIARY_TYPE=rpad(NVL(BENEFICIARY_TYPE,' '),1,' '),
BG_CORRESPONDENT_BANK=rpad(NVL(BG_CORRESPONDENT_BANK,' '),8,' '),
BG_CORRESPONDENT_BRANCH=rpad(NVL(BG_CORRESPONDENT_BRANCH,' '),8,' '),
BG_CORRESPONDENT_NAME=rpad(NVL(BG_CORRESPONDENT_NAME,' '),80,' '),
BG_CORRESPONDENT_ADDRESS1=rpad(NVL(BG_CORRESPONDENT_ADDRESS1,' '),35,' '),
BG_CORRESPONDENT_ADDRESS2=rpad(NVL(BG_CORRESPONDENT_ADDRESS2,' '),35,' '),
BG_CORRESPONDENT_ADDRESS3=rpad(NVL(BG_CORRESPONDENT_ADDRESS3,' '),35,' '),
BG_CORRESPONDENT_CITY=rpad(NVL(BG_CORRESPONDENT_CITY,' '),5,' '),
BG_CORRESPONDENT_STATE=rpad(NVL(BG_CORRESPONDENT_STATE,' '),5,' '),
BG_CORRESPONDENT_COUNTRY=rpad(NVL(BG_CORRESPONDENT_COUNTRY,' '),5,' '),
BG_CORRESPONDENT_PINCODE=rpad(NVL(BG_CORRESPONDENT_PINCODE,' '),10,' '),
BIC_CODE=rpad(NVL(BIC_CODE,' '),11,' '),
PARTY_IDENTIFIER=rpad(NVL(PARTY_IDENTIFIER,' '),37,' '),
CORR_BANK_ADDRESS_TYPE=rpad(NVL(CORR_BANK_ADDRESS_TYPE,' '),1,' '),
BG_CRNCY_CODE=rpad(NVL(BG_CRNCY_CODE,' '),3,' '),
DC_REF_NUM=rpad(NVL(DC_REF_NUM,' '),16,' '),
SG_BILL_EQUIVALENT_CRNCY_CODE=rpad(NVL(SG_BILL_EQUIVALENT_CRNCY_CODE,' '),3,' '),
SG_BILL_EQUIVALENT_AMOUNT=rpad(NVL(SG_BILL_EQUIVALENT_AMOUNT,' '),17,' '),
BG_DC_RATE_CODE=rpad(NVL(BG_DC_RATE_CODE,' '),8,' '),
BG_DC_RATE=rpad(NVL(BG_DC_RATE,' '),8,' '),
SG_CONTINGENT_CRNCY_CODE=rpad(NVL(SG_CONTINGENT_CRNCY_CODE,' '),3,' '),
SG_CONTINGENT_AMOUNT=rpad(NVL(SG_CONTINGENT_AMOUNT,' '),17,' '),
RETAIN_MIN_CONTINGENT_AMOUNT=rpad(NVL(RETAIN_MIN_CONTINGENT_AMOUNT,' '),17,' '),
CONTINGENT_REVERSAL_EVENT=rpad(NVL(CONTINGENT_REVERSAL_EVENT,' '),1,' '),
MARGIN_REVERSAL_RATE_CODE=rpad(NVL(MARGIN_REVERSAL_RATE_CODE,' '),4,' '),
TRUST_RECEIPT_NUM=rpad(NVL(TRUST_RECEIPT_NUM,' '),16,' '),
NO_OF_UNITS=rpad(NVL(NO_OF_UNITS,' '),16,' '),
UNIT_VALUE=rpad(NVL(UNIT_VALUE,' '),17,' '),
COMMODITY_DETAILS_DESC=rpad(NVL(COMMODITY_DETAILS_DESC,' '),30,' '),
COMMODITY_REMARKS=rpad(NVL(COMMODITY_REMARKS,' '),30,' '),
BILL_LADING_NUM=rpad(NVL(BILL_LADING_NUM,' '),35,' '),
CARRIER_ID=rpad(NVL(CARRIER_ID,' '),65,' '),
CARRIER_NAME=rpad(NVL(CARRIER_NAME,' '),25,' '),
CARRIER_ADDRESS1=rpad(NVL(CARRIER_ADDRESS1,' '),50,' '),
CARRIER_ADDRESS2=rpad(NVL(CARRIER_ADDRESS2,' '),50,' '),
CARRIER_ADDRESS3=rpad(NVL(CARRIER_ADDRESS3,' '),50,' '),
CARRIER_CITY=rpad(NVL(CARRIER_CITY,' '),5,' '),
CARRIER_STATE=rpad(NVL(CARRIER_STATE,' '),5,' '),
CARRIER_COUNTRY=rpad(NVL(CARRIER_COUNTRY,' '),5,' '),
CARRIER_PINCODE=rpad(NVL(CARRIER_PINCODE,' '),10,' '),
ORDER_OF_CONSIGNEE=rpad(NVL(ORDER_OF_CONSIGNEE,' '),25,' '),
PORT_OF_DESTINATION=rpad(NVL(PORT_OF_DESTINATION,' '),70,' '),
ACTUAL_SHIPMENT_DATE=rpad(NVL(ACTUAL_SHIPMENT_DATE,' '),10,' '),
LIMITPREFIX=rpad(NVL(LIMITPREFIX,' '),12,' '),
LIMITSUFFIX=rpad(NVL(LIMITSUFFIX,' '),12,' '),
LIMITMARGINPCNT=rpad(NVL(LIMITMARGINPCNT,' '),10,' '),
RELLIMITS=rpad(NVL(RELLIMITS,' '),1,' '),
AMENDMENT_INDICATOR=rpad(NVL(AMENDMENT_INDICATOR,' '),1,' '),
AMENDMENT_REMARKS=rpad(NVL(AMENDMENT_REMARKS,' '),30,' '),
STATUS=rpad(NVL(STATUS,' '),1,' '),
AMENDINITIATEDBY=rpad(NVL(AMENDINITIATEDBY,' '),1,' '),
AUTORENEWAPPLICABLEFLG=rpad(NVL(AUTORENEWAPPLICABLEFLG,' '),1,' '),
FINALEXPIRYDATE=RPAD(NVL(FINALEXPIRYDATE,' '),10,' '),
AUTORENEWNEXTCYCLE=rpad(NVL(AUTORENEWNEXTCYCLE,' '),1,' '),
AUTORENEWFREQTYPE=rpad(NVL(AUTORENEWFREQTYPE,' '),1,' '),
AUTORENEWFREQDATE=rpad(NVL(AUTORENEWFREQDATE,' '),2,' '),
AUTORENEWFREQWEEKNUM=rpad(NVL(AUTORENEWFREQWEEKNUM,' '),1,' '),
AUTORENEWFREQDAY=rpad(NVL(AUTORENEWFREQDAY,' '),2,' '),
ISFREQDAYONHOLIDAY=rpad(NVL(ISFREQDAYONHOLIDAY,' '),1,' '),
BGCOUNTERGUARANTEERATECODE=rpad(NVL(BGCOUNTERGUARANTEERATECODE,' '),5,' '),
COUNTERRATE=rpad(NVL(COUNTERRATE,' '),8,' '),
ADVANCEAMTPAID=rpad(NVL(ADVANCEAMTPAID,' '),17,' '),
SOLIDORDER1=rpad(NVL(SOLIDORDER1,' '),8,' '),
ORDERNODTLS1=rpad(NVL(ORDERNODTLS1,' '),25,' '),
SOLIDORDER2=rpad(NVL(SOLIDORDER2,' '),8,' '),
ORDERNODTLS2=rpad(NVL(ORDERNODTLS2,' '),25,' '),
SOLIDORDER3=rpad(NVL(SOLIDORDER3,' '),8,' '),
ORDERNODTLS3=rpad(NVL(ORDERNODTLS3,' '),25,' '),
SOLIDORDER4=rpad(NVL(SOLIDORDER4,' '),8,' '),
ORDERNODTLS4=rpad(NVL(ORDERNODTLS4,' '),25,' '),
SOLIDORDER5=rpad(NVL(SOLIDORDER5,' '),8,' '),
ORDERNODTLS5=rpad(NVL(ORDERNODTLS5,' '),25,' '),
PURCHASEFORACID=rpad(NVL(PURCHASEFORACID,' '),16,' '),
SGDOPAYABLEFORACID=rpad(NVL(SGDOPAYABLEFORACID,' '),16,' '),
EXECADVNO1=rpad(NVL(EXECADVNO1,' '),16,' '),
EXECADVNO2=rpad(NVL(EXECADVNO2,' '),16,' '),
EXECADVNO3=rpad(NVL(EXECADVNO3,' '),16,' '),
EXECADVNO4=rpad(NVL(EXECADVNO4,' '),16,' '),
EXECADVNO5=rpad(NVL(EXECADVNO5,' '),16,' '),
PROMISETOPURCHASERECV=rpad(NVL(PROMISETOPURCHASERECV,' '),1,' '),
PROMISETOPURCHASEDATE=rpad(NVL(PROMISETOPURCHASEDATE,' '),10,' '),
PROMISETOPURCHASEREFNO=rpad(NVL(PROMISETOPURCHASEREFNO,' '),16,' '),
PURCHASEACCPTADVICE=rpad(NVL(PURCHASEACCPTADVICE,' '),3,' '),
FINANCINGFORACID=rpad(NVL(FINANCINGFORACID,' '),16,' '),
DEBITFINANCINGFORACID=rpad(NVL(DEBITFINANCINGFORACID,' '),1,' '),
PREFIXFINANCINGLIMITID=rpad(NVL(PREFIXFINANCINGLIMITID,' '),12,' '),
SUFFIXFINANCINGLIMITID=rpad(NVL(SUFFIXFINANCINGLIMITID,' '),5,' '),
ISLAMICRATECODE=rpad(NVL(ISLAMICRATECODE,' '),5,' '),
ISLAMICRATE=rpad(NVL(ISLAMICRATE,' '),8,' '),
SECTORCODE=rpad(NVL(SECTORCODE,' '),5,' '),
EXPCIFID=rpad(NVL(EXPCIFID,' '),32,' '),
EXPNAME=rpad(NVL(EXPNAME,' '),80,' '),
EXPADDR1=rpad(NVL(EXPADDR1,' '),45,' '),
EXPADDR2=rpad(NVL(EXPADDR2,' '),45,' '),
EXPADDR3=rpad(NVL(EXPADDR3,' '),45,' '),
EXPCITY=rpad(NVL(EXPCITY,' '),5,' '),
EXPSTATE=rpad(NVL(EXPSTATE,' '),5,' '),
EXPCNTRY=rpad(NVL(EXPCNTRY,' '),5,' '),
EXPPINCODE=rpad(NVL(EXPPINCODE,' '),10,' '),
BGCOLLBANKCODE=rpad(NVL(BGCOLLBANKCODE,' '),6,' '),
BGCOLLBRANCHCODE=rpad(NVL(BGCOLLBRANCHCODE,' '),6,' '),
BGCOLLBANKNAME=rpad(NVL(BGCOLLBANKNAME,' '),80,' '),
BGCOLLBANKADDR1=rpad(NVL(BGCOLLBANKADDR1,' '),45,' '),
BGCOLLBANKADDR2=rpad(NVL(BGCOLLBANKADDR2,' '),45,' '),
BGCOLLBANKADDR3=rpad(NVL(BGCOLLBANKADDR3,' '),45,' '),
BGCOLLBANKCITY=rpad(NVL(BGCOLLBANKCITY,' '),5,' '),
BGCOLLBANKSTATE=rpad(NVL(BGCOLLBANKSTATE,' '),5,' '),
BGCOLLBANKCNTRY=rpad(NVL(BGCOLLBANKCNTRY,' '),5,' '),
BGCOLLBANKPINCODE=rpad(NVL(BGCOLLBANKPINCODE,' '),10,' '),
BGCOLLBICCODE=rpad(NVL(BGCOLLBICCODE,' '),11,' '),
BGCOLLPARTYID=rpad(NVL(BGCOLLPARTYID,' '),35,' '),
BGCOLLADDRTYPE=rpad(NVL(BGCOLLADDRTYPE,' '),1,' '),
INTENDTOEXPORT=rpad(NVL(INTENDTOEXPORT,' '),1,' '),
INWARDDCREFNUM=rpad(NVL(INWARDDCREFNUM,' '),16,' ');

COMMIT;


UPDATE TF001 A SET (EVENT_DATE,BG_EFFECTIVE_DATE) = ( SELECT NEW_EVENT_DATE,NEW_EVENT_DATE FROM(
SELECT ROWID ROW_ID ,BG_NUM,EVENT_DATE,TO_CHAR(TO_DATE(EVENT_DATE,'DD-MM-YYYY')+DENSE_RANK() OVER(PARTITION BY BG_NUM  ORDER BY ROWNUM )-1,'DD-MM-YYYY') NEW_EVENT_DATE FROM TF001_RISK WHERE (BG_NUM,EVENT_DATE) IN(
    SELECT  BG_NUM,EVENT_DATE  FROM TF001_RISK GROUP BY BG_NUM,EVENT_DATE HAVING COUNT(*)>1 
)
) B WHERE A.ROWID = B.ROW_ID
)
WHERE A.ROWID  IN(
SELECT ROWID ROW_ID FROM TF001_RISK WHERE (BG_NUM,EVENT_DATE) IN(
    SELECT  BG_NUM,EVENT_DATE  FROM TF001_RISK GROUP BY BG_NUM,EVENT_DATE HAVING COUNT(*)>1 
));


COMMIT;
