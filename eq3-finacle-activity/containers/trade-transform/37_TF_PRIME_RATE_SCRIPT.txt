---SELECT * FROM TF_PRIME_RATES WHERE '0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6) NOT IN (SELECT FIN_CIF_ID FROM MAP_CIF )

TRUNCATE TABLE TF_SPL_RATE;

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OB' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'LGBD' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'BGADD' EVENT_TYPE, 
BG.EVENT_ID EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(CHARGE_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.BGP BG ON BG.BG_TYPE='LGBD' AND BG.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='GteIssBidN';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OB' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'LGBD' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'BGMOD' EVENT_TYPE, 
BG.EVENT_ID EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(THERE_AFTER) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(THERE_AFTER_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.BGP BG ON BG.BG_TYPE='LGBD' AND BG.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='GteIssBidN';

COMMIT;


INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OB' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'LGBD' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'BGADD' EVENT_TYPE, 
'LGIN 110% MRGN ISS_CHGS' EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(CHARGE_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.BGP BG ON BG.BG_TYPE='LGBD' AND BG.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='GteIssBid';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OB' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'LGBD' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'BGMOD' EVENT_TYPE, 
'LGIN 110% MRGN ISS_CHGS' EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(THERE_AFTER) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(THERE_AFTER_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.BGP BG ON BG.BG_TYPE='LGBD' AND BG.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='GteIssBid';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OB' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'LGOT' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'BGADD' EVENT_TYPE, 
'LGOT_CHGS' EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(CHARGE_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.BGP BG ON BG.BG_TYPE='LGOT' AND BG.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='GteOthers';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OB' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'LGOT' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'BGMOD' EVENT_TYPE, 
'LGOT_CHGS' EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(THERE_AFTER) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(THERE_AFTER_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.BGP BG ON BG.BG_TYPE='LGOT' AND BG.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='GteOthers';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OB' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'LGOT' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'BGADD' EVENT_TYPE, 
'LGOT 110% MRGN ISS_CHGS' EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(CHARGE_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.BGP BG ON BG.BG_TYPE='LGOT' AND BG.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='GteOthersM';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OB' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'LGOT' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'BGMOD' EVENT_TYPE, 
'LGOT 110% MRGN ISS_CHGS' EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(THERE_AFTER) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(THERE_AFTER_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.BGP BG ON BG.BG_TYPE='LGOT' AND BG.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='GteOthersM';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OB' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'LGPR' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'BGADD' EVENT_TYPE, 
'LGPR_CHGS' EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(CHARGE_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.BGP BG ON BG.BG_TYPE='LGPR' AND BG.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='GteIssuePr';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OB' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'LGPR' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'BGMOD' EVENT_TYPE, 
'LGPR_CHGS' EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(THERE_AFTER) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(THERE_AFTER_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.BGP BG ON BG.BG_TYPE='LGPR' AND BG.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='GteIssuePr';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OB' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'LGPU' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'BGADD' EVENT_TYPE, 
'LGFN_CHGS' EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(CHARGE_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.BGP BG ON BG.BG_TYPE='LGPU' AND BG.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='GteIssPurN';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OB' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'LGPU' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'BGMOD' EVENT_TYPE, 
'LGFN_CHGS' EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(THERE_AFTER) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(THERE_AFTER_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.BGP BG ON BG.BG_TYPE='LGPU' AND BG.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='GteIssPurN';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OB' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'LGFN' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'BGADD' EVENT_TYPE, 
'LGFN_CHGS' EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(CHARGE_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.BGP BG ON BG.BG_TYPE='LGFN' AND BG.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='GteIssPurN';


COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OB' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'LGFN' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'BGMOD' EVENT_TYPE, 
'LGFN_CHGS' EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(THERE_AFTER) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(THERE_AFTER_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.BGP BG ON BG.BG_TYPE='LGFN' AND BG.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='GteIssPurN';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OB' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'LGFN' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'BGADD' EVENT_TYPE, 
'LGFN 110% MRGN ISS_CHGS' EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(CHARGE_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.BGP BG ON BG.BG_TYPE='LGFN' AND BG.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='GteIssPurM';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OB' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'LGFN' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'BGMOD' EVENT_TYPE, 
'LGFN 110% MRGN ISS_CHGS' EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(THERE_AFTER) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(THERE_AFTER_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.BGP BG ON BG.BG_TYPE='LGFN' AND BG.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='GteIssPurM';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OB' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'LGPU' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'BGADD' EVENT_TYPE, 
'LGFN 110% MRGN ISS_CHGS' EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(CHARGE_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.BGP BG ON BG.BG_TYPE='LGPU' AND BG.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='GteIssPurM';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OB' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'LGPU' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'BGMOD' EVENT_TYPE, 
'LGFN 110% MRGN ISS_CHGS' EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(THERE_AFTER) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(THERE_AFTER_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.BGP BG ON BG.BG_TYPE='LGPU' AND BG.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='GteIssPurM';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OB' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'LGRT' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'BGADD' EVENT_TYPE, 
'LGRT_CHGS' EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(CHARGE_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.BGP BG ON BG.BG_TYPE='LGRT' AND BG.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='GteIssueP';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OB' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'LGRT' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'BGMOD' EVENT_TYPE, 
'LGRT_CHGS' EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(THERE_AFTER) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(THERE_AFTER_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.BGP BG ON BG.BG_TYPE='LGRT' AND BG.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='GteIssueP';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OB' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'LGAP' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'BGADD' EVENT_TYPE, 
'LGAP_CHGS' EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(CHARGE_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.BGP BG ON BG.BG_TYPE='LGAP' AND BG.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='GteIssueP';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OB' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'LGAP' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'BGMOD' EVENT_TYPE, 
'LGAP_CHGS' EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(THERE_AFTER) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(THERE_AFTER_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.BGP BG ON BG.BG_TYPE='LGAP' AND BG.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='GteIssueP';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OB' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'LGRT' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'BGADD' EVENT_TYPE, 
'LGRT 110% MRGN ISSUE_CHGS' EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(CHARGE_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.BGP BG ON BG.BG_TYPE='LGRT' AND BG.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='GteIssuePM';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OB' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'LGRT' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'BGMOD' EVENT_TYPE, 
'LGRT 110% MRGN ISSUE_CHGS' EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(THERE_AFTER) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(THERE_AFTER_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.BGP BG ON BG.BG_TYPE='LGRT' AND BG.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='GteIssuePM';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OB' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'LGAP' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'BGADD' EVENT_TYPE, 
'LGAP 110% MARGIN_CHGS' EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(CHARGE_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.BGP BG ON BG.BG_TYPE='LGAP' AND BG.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='GteIssuePM';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OB' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'LGAP' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'BGMOD' EVENT_TYPE, 
'LGAP 110% MARGIN_CHGS' EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(THERE_AFTER) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(THERE_AFTER_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.BGP BG ON BG.BG_TYPE='LGAP' AND BG.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='GteIssuePM';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OB' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'LGPH' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'BGADD' EVENT_TYPE, 
BG.EVENT_ID EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(CHARGE_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.BGP BG ON BG.BG_TYPE='LGPH' AND BG.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='GteIssTel';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OB' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'LGPH' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'BGMOD' EVENT_TYPE, 
BG.EVENT_ID EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(THERE_AFTER) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(THERE_AFTER_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.BGP BG ON BG.BG_TYPE='LGPH' AND BG.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='GteIssTel';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OB' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'LGCL' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'BGADD' EVENT_TYPE, 
BG.EVENT_ID EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(CHARGE_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.BGP BG ON BG.BG_TYPE='LGCL' AND BG.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='GteIssColN';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OB' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'LGCL' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'BGMOD' EVENT_TYPE, 
BG.EVENT_ID EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(THERE_AFTER) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(THERE_AFTER_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.BGP BG ON BG.BG_TYPE='LGCL' AND BG.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='GteIssColN';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OD' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'ILCF' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'DCISS' EVENT_TYPE, 
DC.DC_CHRG_CODE EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(CHARGE_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.DCRM DC ON DC.REG_TYPE='ILCF' AND DC.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='Sight Iss';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OD' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'ILCF' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'DCAMD' EVENT_TYPE, 
DC.DC_CHRG_CODE EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(THERE_AFTER) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(THERE_AFTER_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.DCRM DC ON DC.REG_TYPE='ILCF' AND DC.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='Sight Iss';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OD' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'ILCF' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'DCISS' EVENT_TYPE, 
DC.DC_CHRG_CODE EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(CHARGE_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.DCRM DC ON DC.REG_TYPE='ILCF' AND DC.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='Usance Iss';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OD' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'ILCF' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'DCAMD' EVENT_TYPE, 
DC.DC_CHRG_CODE EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(THERE_AFTER) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(THERE_AFTER_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.DCRM DC ON DC.REG_TYPE='ILCF' AND DC.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='Usance Iss';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OD' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'ILCL' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'DCISS' EVENT_TYPE, 
DC.DC_CHRG_CODE EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(CHARGE_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.DCRM DC ON DC.REG_TYPE='ILCL' AND DC.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='SightLoc';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OD' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'ILCL' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'DCAMD' EVENT_TYPE, 
DC.DC_CHRG_CODE EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(THERE_AFTER) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(THERE_AFTER_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.DCRM DC ON DC.REG_TYPE='ILCL' AND DC.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='SightLoc';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OD' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'ILCL' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'DCISS' EVENT_TYPE, 
DC.DC_CHRG_CODE EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(CHARGE_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.DCRM DC ON DC.REG_TYPE='ILCL' AND DC.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='UsanceLoc';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OD' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'ILCL' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'DCAMD' EVENT_TYPE, 
DC.DC_CHRG_CODE EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(THERE_AFTER) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(THERE_AFTER_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.DCRM DC ON DC.REG_TYPE='ILCL' AND DC.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='UsanceLoc';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OD' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'ILCL' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'DCISS' EVENT_TYPE, 
DC.DC_CHRG_CODE EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(CHARGE_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.DCRM DC ON DC.REG_TYPE='ILCL' AND DC.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='SightLocM';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OD' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'ILCL' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'DCAMD' EVENT_TYPE, 
DC.DC_CHRG_CODE EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(THERE_AFTER) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(THERE_AFTER_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.DCRM DC ON DC.REG_TYPE='ILCL' AND DC.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='SightLocM';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OD' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'ILCL' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'DCISS' EVENT_TYPE, 
DC.DC_CHRG_CODE EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(CHARGE_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.DCRM DC ON DC.REG_TYPE='ILCL' AND DC.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='UsanceLocM';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OD' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'ILCL' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'DCAMD' EVENT_TYPE, 
DC.DC_CHRG_CODE EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(THERE_AFTER) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(THERE_AFTER_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.DCRM DC ON DC.REG_TYPE='ILCL' AND DC.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='UsanceLocM';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OD' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'SLCF' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'DCISS' EVENT_TYPE, 
DC.DC_CHRG_CODE EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(CHARGE_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.DCRM DC ON DC.REG_TYPE='SLCF' AND DC.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='ILCSBY';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OD' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'SLCF' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'DCAMD' EVENT_TYPE, 
DC.DC_CHRG_CODE EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(THERE_AFTER) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(THERE_AFTER_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.DCRM DC ON DC.REG_TYPE='SLCF' AND DC.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='ILCSBY';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OD' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'SLCL' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'DCISS' EVENT_TYPE, 
DC.DC_CHRG_CODE EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(CHARGE_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.DCRM DC ON DC.REG_TYPE='SLCL' AND DC.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='ILCSBY';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'OD' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'SLCL' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'DCAMD' EVENT_TYPE, 
DC.DC_CHRG_CODE EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(THERE_AFTER) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(THERE_AFTER_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
LEFT JOIN TBAADM.DCRM DC ON DC.REG_TYPE='SLCL' AND DC.BANK_ID='01'
WHERE TRIM(CHARGE_ID)='ILCSBY';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'IF' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'FIBLU' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'FBCH' EVENT_TYPE, 
'FIBLU_ACCEPT' EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(CHARGE_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
WHERE TRIM(CHARGE_ID)='Acceptance';

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C' CHARGE_LEVEL, 
MC.FIN_CIF_ID CIF_GROUP_ID, 
'IF' ENTITY_TYPE, 
'' BILL_REMIT_EVENT, 
'LIBLU' PROD_CODE, 
'' LIMIT_PREFIX, 
'' LIMIT_SUFFIX, 
'FBCH' EVENT_TYPE, 
'LIBLU_ACCEPT' EVENT_ID, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'FA' ELSE 'TP' END CHARGE_TYPE, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN 'KWD' ELSE '' END CHARGE_CCY, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN TO_CHAR(FIX_AMOUNT) ELSE '' END CHARGE_AMT, 
CASE WHEN UPPER(TRIM(PR.TYPE))='FLAT' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT, 
PERIOD MIN_PERIOD, 
'1' ROUND_PERIOD, 
SUBSTR(CHARGE_FREQ,1,1) CHARGE_PCNT_PERIOD, 
'1' PART_TRAN, 
MIN_CHARGE MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NULL THEN '' ELSE 'KWD' END MINIMUM_CCY, 
'' SCRIPT_NAME, 
'' PTT_SCRIPT_NAME, 
'' FREE_TEXT_1, 
'' FREE_TEXT_2, 
'' FREE_TEXT_3, 
'' FREE_CODE_1, 
'' FREE_CODE_2, 
'' FREE_CODE_3, 
'Y' ENTITY_CRE_FLG, 
'N' DEL_FLG, 
SYSDATE RCRE_TIME, 
'UBSADMIN' RCRE_USER_ID, 
SYSDATE LCHG_TIME, 
'UBSADMIN' LCHG_USER_ID, 
'01' BANK_ID, 
CASE WHEN TRIM(DIFF)=0 THEN '' ELSE TO_CHAR(DIFF) END MIN_PERIOD_PCNT
FROM TF_PRIME_RATES PR
LEFT JOIN MAP_CIF MC ON MC.FIN_CIF_ID='0'||SUBSTR(TRIM(CUSTOMER),8,3)||SUBSTR(TRIM(CUSTOMER),1,6)
WHERE TRIM(CHARGE_ID)='Acceptance';

COMMIT;

DELETE FROM TF_SPL_RATE WHERE TRIM(CIF_GROUP_ID) IS NULL;

COMMIT;


--SELECT * FROM TF_SPL_RATE WHERE TRIM(CIF_GROUP_ID)='0600022661'


DELETE FROM TF_SPL_RATE WHERE ROWID NOT IN 
(SELECT MAX(ROWID) 
FROM TF_SPL_RATE TF WHERE (CIF_GROUP_ID, ENTITY_TYPE, PROD_CODE, EVENT_ID, EVENT_TYPE) IN
(SELECT  
CIF_GROUP_ID, ENTITY_TYPE, PROD_CODE, EVENT_ID, EVENT_TYPE 
FROM TF_SPL_RATE  
GROUP BY CIF_GROUP_ID, ENTITY_TYPE, PROD_CODE, EVENT_ID, EVENT_TYPE 
HAVING COUNT(1) > 1)
GROUP BY CIF_GROUP_ID, ENTITY_TYPE, PROD_CODE, EVENT_ID, EVENT_TYPE
)
AND (CIF_GROUP_ID, ENTITY_TYPE, PROD_CODE, EVENT_ID, EVENT_TYPE) IN 
(SELECT  
CIF_GROUP_ID, ENTITY_TYPE, PROD_CODE, EVENT_ID, EVENT_TYPE 
FROM TF_SPL_RATE  
GROUP BY CIF_GROUP_ID, ENTITY_TYPE, PROD_CODE, EVENT_ID, EVENT_TYPE 
HAVING COUNT(1) > 1);

COMMIT;
