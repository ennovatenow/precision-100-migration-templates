TRUNCATE TABLE TF_SPL_RATE;

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C',
FIN_CIF_ID,
'OB' ENTITY_TYPE,
'' BILL_REMIT_EVENT,
BG_TYPE,
'' LIMIT_PREFIX,
'' LIMIT_SUFIX,
CASE WHEN TRIM(LG.DESCR)='LG Amd Oth/Per/Ret/Adv inc' THEN 'BGMOD' ELSE '' END EVENT_TYPE,
EVENT_ID,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'FA' ELSE 'TP' END CHARGE_TYPE,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'KWD' ELSE '' END CHARGE_CCY,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN TO_CHAR(CHARGE) ELSE '' END CHARGE_AMT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN '1' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN '3'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN '6'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN '12'
     ELSE TO_CHAR(LG.PERIOD) END, 
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN 'M'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN 'Q'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN 'H'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN 'Y'
END CHARGE_PCNT_PERIOD,
'1' PART_TRAN,
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN TO_CHAR(MIN_CHARGE) ELSE '' END MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN 'KWD' ELSE '' END MINIMUM_CCY,
'' SCRIPT_NAME,
'trfbgchrgmn001.scr' PTT_SCRIPT_NAME,
''FREE_TEXT_1,''FREE_TEXT_2,''FREE_TEXT_3,''FREE_CODE_1,''FREE_CODE_2,''FREE_CODE_3,
'Y'ENTITY_CRE_FLG,'N'DEL_FLG,SYSDATE RCRE_TIME,'SYSTEM' RCRE_USER_ID, SYSDATE LCHG_TIME,'SYSTEM' LCHG_USER_ID, '01' BANK_ID, ''MIN_PERIOD_PCNT
FROM TF_LGPRICE_LIST LG
INNER JOIN TBAADM.BGP P ON  BG_TYPE=
CASE WHEN TRIM(LG.DESCR)='LG Amd Oth/Per/Ret/Adv inc' THEN 'LGOT'
ELSE '' END AND BANK_ID='01' 
LEFT JOIN MAP_CIF CI ON TRIM(GFCUS)||TRIM(GFCLC)=TRIM(REPLACE(CUSTOMER,' ',''));

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C',
FIN_CIF_ID,
'OB' ENTITY_TYPE,
'' BILL_REMIT_EVENT,
BG_TYPE,
'' LIMIT_PREFIX,
'' LIMIT_SUFIX,
CASE WHEN TRIM(LG.DESCR)='LG Amd Oth/Per/Ret/Adv inc' THEN 'BGMOD' ELSE '' END EVENT_TYPE,
EVENT_ID,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'FA' ELSE 'TP' END CHARGE_TYPE,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'KWD' ELSE '' END CHARGE_CCY,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN TO_CHAR(CHARGE) ELSE '' END CHARGE_AMT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN '1' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN '3'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN '6'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN '12'
     ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN 'M'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN 'Q'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN 'H'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN 'Y'
END CHARGE_PCNT_PERIOD,
'1' PART_TRAN,
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN TO_CHAR(MIN_CHARGE) ELSE '' END MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN 'KWD' ELSE '' END MINIMUM_CCY,
'' SCRIPT_NAME,
'trfbgchrgmn001.scr' PTT_SCRIPT_NAME,
''FREE_TEXT_1,''FREE_TEXT_2,''FREE_TEXT_3,''FREE_CODE_1,''FREE_CODE_2,''FREE_CODE_3,
'Y'ENTITY_CRE_FLG,'N'DEL_FLG,SYSDATE RCRE_TIME,'SYSTEM' RCRE_USER_ID, SYSDATE LCHG_TIME,'SYSTEM' LCHG_USER_ID, '01' BANK_ID, ''MIN_PERIOD_PCNT
FROM TF_LGPRICE_LIST LG
INNER JOIN TBAADM.BGP P ON  BG_TYPE=
CASE WHEN TRIM(LG.DESCR)='LG Amd Oth/Per/Ret/Adv inc' THEN 'LGPR'
ELSE '' END AND BANK_ID='01' 
LEFT JOIN MAP_CIF CI ON TRIM(GFCUS)||TRIM(GFCLC)=TRIM(REPLACE(CUSTOMER,' ',''));

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C',
FIN_CIF_ID,
'OB' ENTITY_TYPE,
'' BILL_REMIT_EVENT,
BG_TYPE,
'' LIMIT_PREFIX,
'' LIMIT_SUFIX,
CASE WHEN TRIM(LG.DESCR)='LG Amd Oth/Per/Ret/Adv inc' THEN 'BGMOD' ELSE '' END EVENT_TYPE,
EVENT_ID,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'FA' ELSE 'TP' END CHARGE_TYPE,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'KWD' ELSE '' END CHARGE_CCY,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN TO_CHAR(CHARGE) ELSE '' END CHARGE_AMT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN '1' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN '3'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN '6'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN '12'
     ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN 'M'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN 'Q'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN 'H'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN 'Y'
END CHARGE_PCNT_PERIOD,
'1' PART_TRAN,
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN TO_CHAR(MIN_CHARGE) ELSE '' END MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN 'KWD' ELSE '' END MINIMUM_CCY,
'' SCRIPT_NAME,
'trfbgchrgmn001.scr' PTT_SCRIPT_NAME,
''FREE_TEXT_1,''FREE_TEXT_2,''FREE_TEXT_3,''FREE_CODE_1,''FREE_CODE_2,''FREE_CODE_3,
'Y'ENTITY_CRE_FLG,'N'DEL_FLG,SYSDATE RCRE_TIME,'SYSTEM' RCRE_USER_ID, SYSDATE LCHG_TIME,'SYSTEM' LCHG_USER_ID, '01' BANK_ID, ''MIN_PERIOD_PCNT
FROM TF_LGPRICE_LIST LG
INNER JOIN TBAADM.BGP P ON  BG_TYPE=
CASE WHEN TRIM(LG.DESCR)='LG Amd Oth/Per/Ret/Adv inc' THEN 'LGRT'
ELSE '' END AND BANK_ID='01' 
LEFT JOIN MAP_CIF CI ON TRIM(GFCUS)||TRIM(GFCLC)=TRIM(REPLACE(CUSTOMER,' ',''));

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C',
FIN_CIF_ID,
'OB' ENTITY_TYPE,
'' BILL_REMIT_EVENT,
BG_TYPE,
'' LIMIT_PREFIX,
'' LIMIT_SUFIX,
CASE WHEN TRIM(LG.DESCR)='LG Amd Oth/Per/Ret/Adv inc' THEN 'BGMOD' ELSE '' END EVENT_TYPE,
EVENT_ID,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'FA' ELSE 'TP' END CHARGE_TYPE,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'KWD' ELSE '' END CHARGE_CCY,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN TO_CHAR(CHARGE) ELSE '' END CHARGE_AMT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN '1' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN '3'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN '6'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN '12'
     ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN 'M'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN 'Q'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN 'H'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN 'Y'
END CHARGE_PCNT_PERIOD,
'1' PART_TRAN,
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN TO_CHAR(MIN_CHARGE) ELSE '' END MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN 'KWD' ELSE '' END MINIMUM_CCY,
'' SCRIPT_NAME,
'trfbgchrgmn001.scr' PTT_SCRIPT_NAME,
''FREE_TEXT_1,''FREE_TEXT_2,''FREE_TEXT_3,''FREE_CODE_1,''FREE_CODE_2,''FREE_CODE_3,
'Y'ENTITY_CRE_FLG,'N'DEL_FLG,SYSDATE RCRE_TIME,'SYSTEM' RCRE_USER_ID, SYSDATE LCHG_TIME,'SYSTEM' LCHG_USER_ID, '01' BANK_ID, ''MIN_PERIOD_PCNT
FROM TF_LGPRICE_LIST LG
INNER JOIN TBAADM.BGP P ON  BG_TYPE=
CASE WHEN TRIM(LG.DESCR)='LG Amd Oth/Per/Ret/Adv inc' THEN 'LGAP'
ELSE '' END AND BANK_ID='01' 
LEFT JOIN MAP_CIF CI ON TRIM(GFCUS)||TRIM(GFCLC)=TRIM(REPLACE(CUSTOMER,' ',''));

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C',
FIN_CIF_ID,
'OB' ENTITY_TYPE,
'' BILL_REMIT_EVENT,
BG_TYPE,
'' LIMIT_PREFIX,
'' LIMIT_SUFIX,
CASE WHEN TRIM(LG.DESCR)='LG Amd Purchase increase' THEN 'BGMOD' ELSE '' END EVENT_TYPE,
EVENT_ID,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'FA' ELSE 'TP' END CHARGE_TYPE,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'KWD' ELSE '' END CHARGE_CCY,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN TO_CHAR(CHARGE) ELSE '' END CHARGE_AMT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN '1' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN '3'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN '6'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN '12'
     ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN 'M'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN 'Q'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN 'H'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN 'Y'
END CHARGE_PCNT_PERIOD,
'1' PART_TRAN,
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN TO_CHAR(MIN_CHARGE) ELSE '' END MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN 'KWD' ELSE '' END MINIMUM_CCY,
'' SCRIPT_NAME,
'trfbgchrgmn001.scr' PTT_SCRIPT_NAME,
''FREE_TEXT_1,''FREE_TEXT_2,''FREE_TEXT_3,''FREE_CODE_1,''FREE_CODE_2,''FREE_CODE_3,
'Y'ENTITY_CRE_FLG,'N'DEL_FLG,SYSDATE RCRE_TIME,'SYSTEM' RCRE_USER_ID, SYSDATE LCHG_TIME,'SYSTEM' LCHG_USER_ID, '01' BANK_ID, ''MIN_PERIOD_PCNT
FROM TF_LGPRICE_LIST LG
INNER JOIN TBAADM.BGP P ON  BG_TYPE=
CASE WHEN TRIM(LG.DESCR)='LG Amd Purchase increase' THEN 'LGPU'
ELSE '' END AND BANK_ID='01' 
LEFT JOIN MAP_CIF CI ON TRIM(GFCUS)||TRIM(GFCLC)=TRIM(REPLACE(CUSTOMER,' ',''));

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C',
FIN_CIF_ID,
'OB' ENTITY_TYPE,
'' BILL_REMIT_EVENT,
BG_TYPE,
'' LIMIT_PREFIX,
'' LIMIT_SUFIX,
CASE WHEN TRIM(LG.DESCR)='LG Amd initial ext' THEN 'BGMOD' ELSE '' END EVENT_TYPE,
EVENT_ID,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'FA' ELSE 'TP' END CHARGE_TYPE,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'KWD' ELSE '' END CHARGE_CCY,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN TO_CHAR(CHARGE) ELSE '' END CHARGE_AMT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN '1' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN '3'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN '6'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN '12'
     ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN 'M'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN 'Q'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN 'H'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN 'Y'
END CHARGE_PCNT_PERIOD,
'1' PART_TRAN,
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN TO_CHAR(MIN_CHARGE) ELSE '' END MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN 'KWD' ELSE '' END MINIMUM_CCY,
'' SCRIPT_NAME,
'trfbgchrgmn001.scr' PTT_SCRIPT_NAME,
''FREE_TEXT_1,''FREE_TEXT_2,''FREE_TEXT_3,''FREE_CODE_1,''FREE_CODE_2,''FREE_CODE_3,
'Y'ENTITY_CRE_FLG,'N'DEL_FLG,SYSDATE RCRE_TIME,'SYSTEM' RCRE_USER_ID, SYSDATE LCHG_TIME,'SYSTEM' LCHG_USER_ID, '01' BANK_ID, ''MIN_PERIOD_PCNT
FROM TF_LGPRICE_LIST LG
INNER JOIN TBAADM.BGP P ON  BG_TYPE=
CASE WHEN TRIM(LG.DESCR)='LG Amd initial ext' THEN 'LGBD'
ELSE '' END AND BANK_ID='01' 
LEFT JOIN MAP_CIF CI ON TRIM(GFCUS)||TRIM(GFCLC)=TRIM(REPLACE(CUSTOMER,' ',''));

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C',
FIN_CIF_ID,
'OB' ENTITY_TYPE,
'' BILL_REMIT_EVENT,
BG_TYPE,
'' LIMIT_PREFIX,
'' LIMIT_SUFIX,
CASE WHEN TRIM(LG.DESCR)='LG Others' THEN 'BGADD' ELSE '' END EVENT_TYPE,
EVENT_ID,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'FA' ELSE 'TP' END CHARGE_TYPE,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'KWD' ELSE '' END CHARGE_CCY,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN TO_CHAR(CHARGE) ELSE '' END CHARGE_AMT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN '1' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN '3'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN '6'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN '12'
     ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN 'M'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN 'Q'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN 'H'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN 'Y'
END CHARGE_PCNT_PERIOD,
'1' PART_TRAN,
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN TO_CHAR(MIN_CHARGE) ELSE '' END MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN 'KWD' ELSE '' END MINIMUM_CCY,
'' SCRIPT_NAME,
'trfbgchrgmn001.scr' PTT_SCRIPT_NAME,
''FREE_TEXT_1,''FREE_TEXT_2,''FREE_TEXT_3,''FREE_CODE_1,''FREE_CODE_2,''FREE_CODE_3,
'Y'ENTITY_CRE_FLG,'N'DEL_FLG,SYSDATE RCRE_TIME,'SYSTEM' RCRE_USER_ID, SYSDATE LCHG_TIME,'SYSTEM' LCHG_USER_ID, '01' BANK_ID, ''MIN_PERIOD_PCNT
FROM TF_LGPRICE_LIST LG
INNER JOIN TBAADM.BGP P ON  BG_TYPE=
CASE WHEN TRIM(LG.DESCR)='LG Others' THEN 'LGOT'
ELSE '' END AND BANK_ID='01' 
LEFT JOIN MAP_CIF CI ON TRIM(GFCUS)||TRIM(GFCLC)=TRIM(REPLACE(CUSTOMER,' ',''));

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C',
FIN_CIF_ID,
'OB' ENTITY_TYPE,
'' BILL_REMIT_EVENT,
BG_TYPE,
'' LIMIT_PREFIX,
'' LIMIT_SUFIX,
CASE WHEN TRIM(LG.DESCR)='LG Perf/Ret/Adv' THEN 'BGADD' ELSE '' END EVENT_TYPE,
EVENT_ID,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'FA' ELSE 'TP' END CHARGE_TYPE,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'KWD' ELSE '' END CHARGE_CCY,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN TO_CHAR(CHARGE) ELSE '' END CHARGE_AMT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN '1' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN '3'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN '6'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN '12'
     ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN 'M'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN 'Q'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN 'H'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN 'Y'
END CHARGE_PCNT_PERIOD,
'1' PART_TRAN,
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN TO_CHAR(MIN_CHARGE) ELSE '' END MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN 'KWD' ELSE '' END MINIMUM_CCY,
'' SCRIPT_NAME,
'trfbgchrgmn001.scr' PTT_SCRIPT_NAME,
''FREE_TEXT_1,''FREE_TEXT_2,''FREE_TEXT_3,''FREE_CODE_1,''FREE_CODE_2,''FREE_CODE_3,
'Y'ENTITY_CRE_FLG,'N'DEL_FLG,SYSDATE RCRE_TIME,'SYSTEM' RCRE_USER_ID, SYSDATE LCHG_TIME,'SYSTEM' LCHG_USER_ID, '01' BANK_ID, ''MIN_PERIOD_PCNT
FROM TF_LGPRICE_LIST LG
INNER JOIN TBAADM.BGP P ON  BG_TYPE=
CASE WHEN TRIM(LG.DESCR)='LG Perf/Ret/Adv' THEN 'LGPR'
ELSE '' END AND BANK_ID='01' 
LEFT JOIN MAP_CIF CI ON TRIM(GFCUS)||TRIM(GFCLC)=TRIM(REPLACE(CUSTOMER,' ',''));

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C',
FIN_CIF_ID,
'OB' ENTITY_TYPE,
'' BILL_REMIT_EVENT,
BG_TYPE,
'' LIMIT_PREFIX,
'' LIMIT_SUFIX,
CASE WHEN TRIM(LG.DESCR)='LG Perf/Ret/Adv' THEN 'BGADD' ELSE '' END EVENT_TYPE,
EVENT_ID,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'FA' ELSE 'TP' END CHARGE_TYPE,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'KWD' ELSE '' END CHARGE_CCY,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN TO_CHAR(CHARGE) ELSE '' END CHARGE_AMT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN '1' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN '3'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN '6'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN '12'
     ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN 'M'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN 'Q'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN 'H'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN 'Y'
END CHARGE_PCNT_PERIOD,
'1' PART_TRAN,
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN TO_CHAR(MIN_CHARGE) ELSE '' END MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN 'KWD' ELSE '' END MINIMUM_CCY,
'' SCRIPT_NAME,
'trfbgchrgmn001.scr' PTT_SCRIPT_NAME,
''FREE_TEXT_1,''FREE_TEXT_2,''FREE_TEXT_3,''FREE_CODE_1,''FREE_CODE_2,''FREE_CODE_3,
'Y'ENTITY_CRE_FLG,'N'DEL_FLG,SYSDATE RCRE_TIME,'SYSTEM' RCRE_USER_ID, SYSDATE LCHG_TIME,'SYSTEM' LCHG_USER_ID, '01' BANK_ID, ''MIN_PERIOD_PCNT
FROM TF_LGPRICE_LIST LG
INNER JOIN TBAADM.BGP P ON  BG_TYPE=
CASE WHEN TRIM(LG.DESCR)='LG Perf/Ret/Adv' THEN 'LGRT'
ELSE '' END AND BANK_ID='01' 
LEFT JOIN MAP_CIF CI ON TRIM(GFCUS)||TRIM(GFCLC)=TRIM(REPLACE(CUSTOMER,' ',''));

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C',
FIN_CIF_ID,
'OB' ENTITY_TYPE,
'' BILL_REMIT_EVENT,
BG_TYPE,
'' LIMIT_PREFIX,
'' LIMIT_SUFIX,
CASE WHEN TRIM(LG.DESCR)='LG Perf/Ret/Adv' THEN 'BGADD' ELSE '' END EVENT_TYPE,
EVENT_ID,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'FA' ELSE 'TP' END CHARGE_TYPE,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'KWD' ELSE '' END CHARGE_CCY,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN TO_CHAR(CHARGE) ELSE '' END CHARGE_AMT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN '1' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN '3'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN '6'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN '12'
     ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN 'M'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN 'Q'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN 'H'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN 'Y'
END CHARGE_PCNT_PERIOD,
'1' PART_TRAN,
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN TO_CHAR(MIN_CHARGE) ELSE '' END MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN 'KWD' ELSE '' END MINIMUM_CCY,
'' SCRIPT_NAME,
'trfbgchrgmn001.scr' PTT_SCRIPT_NAME,
''FREE_TEXT_1,''FREE_TEXT_2,''FREE_TEXT_3,''FREE_CODE_1,''FREE_CODE_2,''FREE_CODE_3,
'Y'ENTITY_CRE_FLG,'N'DEL_FLG,SYSDATE RCRE_TIME,'SYSTEM' RCRE_USER_ID, SYSDATE LCHG_TIME,'SYSTEM' LCHG_USER_ID, '01' BANK_ID, ''MIN_PERIOD_PCNT
FROM TF_LGPRICE_LIST LG
INNER JOIN TBAADM.BGP P ON  BG_TYPE=
CASE WHEN TRIM(LG.DESCR)='LG Perf/Ret/Adv' THEN 'LGAP'
ELSE '' END AND BANK_ID='01' 
LEFT JOIN MAP_CIF CI ON TRIM(GFCUS)||TRIM(GFCLC)=TRIM(REPLACE(CUSTOMER,' ',''));

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C',
FIN_CIF_ID,
'OB' ENTITY_TYPE,
'' BILL_REMIT_EVENT,
BG_TYPE,
'' LIMIT_PREFIX,
'' LIMIT_SUFIX,
CASE WHEN TRIM(LG.DESCR)='LG Purchase/Cash' THEN 'BGADD' ELSE '' END EVENT_TYPE,
EVENT_ID,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'FA' ELSE 'TP' END CHARGE_TYPE,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'KWD' ELSE '' END CHARGE_CCY,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN TO_CHAR(CHARGE) ELSE '' END CHARGE_AMT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN '1' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN '3'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN '6'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN '12'
     ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN 'M'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN 'Q'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN 'H'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN 'Y'
END CHARGE_PCNT_PERIOD,
'1' PART_TRAN,
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN TO_CHAR(MIN_CHARGE) ELSE '' END MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN 'KWD' ELSE '' END MINIMUM_CCY,
'' SCRIPT_NAME,
'trfbgchrgmn001.scr' PTT_SCRIPT_NAME,
''FREE_TEXT_1,''FREE_TEXT_2,''FREE_TEXT_3,''FREE_CODE_1,''FREE_CODE_2,''FREE_CODE_3,
'Y'ENTITY_CRE_FLG,'N'DEL_FLG,SYSDATE RCRE_TIME,'SYSTEM' RCRE_USER_ID, SYSDATE LCHG_TIME,'SYSTEM' LCHG_USER_ID, '01' BANK_ID, ''MIN_PERIOD_PCNT
FROM TF_LGPRICE_LIST LG
INNER JOIN TBAADM.BGP P ON  BG_TYPE=
CASE WHEN TRIM(LG.DESCR)='LG Purchase/Cash' THEN 'LGPU'
ELSE '' END AND BANK_ID='01' 
LEFT JOIN MAP_CIF CI ON TRIM(GFCUS)||TRIM(GFCLC)=TRIM(REPLACE(CUSTOMER,' ',''));

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C',
FIN_CIF_ID,
'OB' ENTITY_TYPE,
'' BILL_REMIT_EVENT,
BG_TYPE,
'' LIMIT_PREFIX,
'' LIMIT_SUFIX,
CASE WHEN TRIM(LG.DESCR)='LG Purchase/Cash' THEN 'BGADD' ELSE '' END EVENT_TYPE,
EVENT_ID,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'FA' ELSE 'TP' END CHARGE_TYPE,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'KWD' ELSE '' END CHARGE_CCY,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN TO_CHAR(CHARGE) ELSE '' END CHARGE_AMT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN '1' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN '3'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN '6'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN '12'
     ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN 'M'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN 'Q'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN 'H'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN 'Y'
END CHARGE_PCNT_PERIOD,
'1' PART_TRAN,
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN TO_CHAR(MIN_CHARGE) ELSE '' END MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN 'KWD' ELSE '' END MINIMUM_CCY,
'' SCRIPT_NAME,
'trfbgchrgmn001.scr' PTT_SCRIPT_NAME,
''FREE_TEXT_1,''FREE_TEXT_2,''FREE_TEXT_3,''FREE_CODE_1,''FREE_CODE_2,''FREE_CODE_3,
'Y'ENTITY_CRE_FLG,'N'DEL_FLG,SYSDATE RCRE_TIME,'SYSTEM' RCRE_USER_ID, SYSDATE LCHG_TIME,'SYSTEM' LCHG_USER_ID, '01' BANK_ID, ''MIN_PERIOD_PCNT
FROM TF_LGPRICE_LIST LG
INNER JOIN TBAADM.BGP P ON  BG_TYPE=
CASE WHEN TRIM(LG.DESCR)='LG Purchase/Cash' THEN 'LGFN'
ELSE '' END AND BANK_ID='01' 
LEFT JOIN MAP_CIF CI ON TRIM(GFCUS)||TRIM(GFCLC)=TRIM(REPLACE(CUSTOMER,' ',''));

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C',
FIN_CIF_ID,
'OB' ENTITY_TYPE,
'' BILL_REMIT_EVENT,
BG_TYPE,
'' LIMIT_PREFIX,
'' LIMIT_SUFIX,
CASE WHEN TRIM(LG.DESCR)='LG Telephone' THEN 'BGADD' ELSE '' END EVENT_TYPE,
EVENT_ID,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'FA' ELSE 'TP' END CHARGE_TYPE,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'KWD' ELSE '' END CHARGE_CCY,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN TO_CHAR(CHARGE) ELSE '' END CHARGE_AMT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN '1' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN '3'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN '6'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN '12'
     ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN 'M'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN 'Q'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN 'H'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN 'Y'
END CHARGE_PCNT_PERIOD,
'1' PART_TRAN,
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN TO_CHAR(MIN_CHARGE) ELSE '' END MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN 'KWD' ELSE '' END MINIMUM_CCY,
'' SCRIPT_NAME,
'trfbgchrgmn001.scr' PTT_SCRIPT_NAME,
''FREE_TEXT_1,''FREE_TEXT_2,''FREE_TEXT_3,''FREE_CODE_1,''FREE_CODE_2,''FREE_CODE_3,
'Y'ENTITY_CRE_FLG,'N'DEL_FLG,SYSDATE RCRE_TIME,'SYSTEM' RCRE_USER_ID, SYSDATE LCHG_TIME,'SYSTEM' LCHG_USER_ID, '01' BANK_ID, ''MIN_PERIOD_PCNT
FROM TF_LGPRICE_LIST LG
INNER JOIN TBAADM.BGP P ON  BG_TYPE=
CASE WHEN TRIM(LG.DESCR)='LG Telephone' THEN 'LGPH'
ELSE '' END AND BANK_ID='01' 
LEFT JOIN MAP_CIF CI ON TRIM(GFCUS)||TRIM(GFCLC)=TRIM(REPLACE(CUSTOMER,' ',''));

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C',
FIN_CIF_ID,
'OB' ENTITY_TYPE,
'' BILL_REMIT_EVENT,
BG_TYPE,
'' LIMIT_PREFIX,
'' LIMIT_SUFIX,
CASE WHEN TRIM(LG.DESCR)='LG initial' THEN 'BGADD' ELSE '' END EVENT_TYPE,
EVENT_ID,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'FA' ELSE 'TP' END CHARGE_TYPE,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'KWD' ELSE '' END CHARGE_CCY,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN TO_CHAR(CHARGE) ELSE '' END CHARGE_AMT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN '1' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN '3'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN '6'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN '12'
     ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN 'M'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN 'Q'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN 'H'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN 'Y'
END CHARGE_PCNT_PERIOD,
'1' PART_TRAN,
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN TO_CHAR(MIN_CHARGE) ELSE '' END MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN 'KWD' ELSE '' END MINIMUM_CCY,
'' SCRIPT_NAME,
'trfbgchrgmn001.scr' PTT_SCRIPT_NAME,
''FREE_TEXT_1,''FREE_TEXT_2,''FREE_TEXT_3,''FREE_CODE_1,''FREE_CODE_2,''FREE_CODE_3,
'Y'ENTITY_CRE_FLG,'N'DEL_FLG,SYSDATE RCRE_TIME,'SYSTEM' RCRE_USER_ID, SYSDATE LCHG_TIME,'SYSTEM' LCHG_USER_ID, '01' BANK_ID, ''MIN_PERIOD_PCNT
FROM TF_LGPRICE_LIST LG
INNER JOIN TBAADM.BGP P ON  BG_TYPE=
CASE WHEN TRIM(LG.DESCR)='LG initial' THEN 'LGBD'
ELSE '' END AND BANK_ID='01' 
LEFT JOIN MAP_CIF CI ON TRIM(GFCUS)||TRIM(GFCLC)=TRIM(REPLACE(CUSTOMER,' ',''));

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C',
FIN_CIF_ID,
'OB' ENTITY_TYPE,
'' BILL_REMIT_EVENT,
BG_TYPE,
'' LIMIT_PREFIX,
'' LIMIT_SUFIX,
CASE WHEN TRIM(LG.DESCR)='LG initial+Margin' THEN 'BGADD' ELSE '' END EVENT_TYPE,
'LGIN 110% MRGN ISS_CHGS' EVENT_ID,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'FA' ELSE 'TP' END CHARGE_TYPE,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'KWD' ELSE '' END CHARGE_CCY,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN TO_CHAR(CHARGE) ELSE '' END CHARGE_AMT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN '1' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN '3'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN '6'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN '12'
     ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN 'M'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN 'Q'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN 'H'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN 'Y'
END CHARGE_PCNT_PERIOD,
'1' PART_TRAN,
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN TO_CHAR(MIN_CHARGE) ELSE '' END MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN 'KWD' ELSE '' END MINIMUM_CCY,
'' SCRIPT_NAME,
'trfbgchrgmn001.scr' PTT_SCRIPT_NAME,
''FREE_TEXT_1,''FREE_TEXT_2,''FREE_TEXT_3,''FREE_CODE_1,''FREE_CODE_2,''FREE_CODE_3,
'Y'ENTITY_CRE_FLG,'N'DEL_FLG,SYSDATE RCRE_TIME,'SYSTEM' RCRE_USER_ID, SYSDATE LCHG_TIME,'SYSTEM' LCHG_USER_ID, '01' BANK_ID, ''MIN_PERIOD_PCNT
FROM TF_LGPRICE_LIST LG
INNER JOIN TBAADM.BGP P ON  BG_TYPE=
CASE WHEN TRIM(LG.DESCR)='LG initial+Margin' THEN 'LGBD'
ELSE '' END AND BANK_ID='01' 
LEFT JOIN MAP_CIF CI ON TRIM(GFCUS)||TRIM(GFCLC)=TRIM(REPLACE(CUSTOMER,' ',''));

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C',
FIN_CIF_ID,
'OB' ENTITY_TYPE,
'' BILL_REMIT_EVENT,
BG_TYPE,
'' LIMIT_PREFIX,
'' LIMIT_SUFIX,
CASE WHEN TRIM(LG.DESCR)='LG initial+Margin' THEN 'BGMOD' ELSE '' END EVENT_TYPE,
'LGIN 110% MRGN AMEND_CHGS' EVENT_ID,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'FA' ELSE 'TP' END CHARGE_TYPE,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'KWD' ELSE '' END CHARGE_CCY,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN TO_CHAR(CHARGE) ELSE '' END CHARGE_AMT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN '1' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN '3'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN '6'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN '12'
     ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN 'M'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN 'Q'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN 'H'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN 'Y'
END CHARGE_PCNT_PERIOD,
'1' PART_TRAN,
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN TO_CHAR(MIN_CHARGE) ELSE '' END MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN 'KWD' ELSE '' END MINIMUM_CCY,
'' SCRIPT_NAME,
'trfbgchrgmn001.scr' PTT_SCRIPT_NAME,
''FREE_TEXT_1,''FREE_TEXT_2,''FREE_TEXT_3,''FREE_CODE_1,''FREE_CODE_2,''FREE_CODE_3,
'Y'ENTITY_CRE_FLG,'N'DEL_FLG,SYSDATE RCRE_TIME,'SYSTEM' RCRE_USER_ID, SYSDATE LCHG_TIME,'SYSTEM' LCHG_USER_ID, '01' BANK_ID, ''MIN_PERIOD_PCNT
FROM TF_LGPRICE_LIST LG
INNER JOIN TBAADM.BGP P ON  BG_TYPE=
CASE WHEN TRIM(LG.DESCR)='LG initial+Margin' THEN 'LGBD'
ELSE '' END AND BANK_ID='01' 
LEFT JOIN MAP_CIF CI ON TRIM(GFCUS)||TRIM(GFCLC)=TRIM(REPLACE(CUSTOMER,' ',''));

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C',
FIN_CIF_ID,
'OB' ENTITY_TYPE,
'' BILL_REMIT_EVENT,
BG_TYPE,
'' LIMIT_PREFIX,
'' LIMIT_SUFIX,
CASE WHEN TRIM(LG.DESCR)='LG Purchase/Cash+Margin' THEN 'BGADD' ELSE '' END EVENT_TYPE,
'LGFN 110% MRGN ISS_CHGS' EVENT_ID,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'FA' ELSE 'TP' END CHARGE_TYPE,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'KWD' ELSE '' END CHARGE_CCY,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN TO_CHAR(CHARGE) ELSE '' END CHARGE_AMT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN '1' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN '3'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN '6'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN '12'
     ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN 'M'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN 'Q'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN 'H'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN 'Y'
END CHARGE_PCNT_PERIOD,
'1' PART_TRAN,
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN TO_CHAR(MIN_CHARGE) ELSE '' END MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN 'KWD' ELSE '' END MINIMUM_CCY,
'' SCRIPT_NAME,
'trfbgchrgmn001.scr' PTT_SCRIPT_NAME,
''FREE_TEXT_1,''FREE_TEXT_2,''FREE_TEXT_3,''FREE_CODE_1,''FREE_CODE_2,''FREE_CODE_3,
'Y'ENTITY_CRE_FLG,'N'DEL_FLG,SYSDATE RCRE_TIME,'SYSTEM' RCRE_USER_ID, SYSDATE LCHG_TIME,'SYSTEM' LCHG_USER_ID, '01' BANK_ID, ''MIN_PERIOD_PCNT
FROM TF_LGPRICE_LIST LG
INNER JOIN TBAADM.BGP P ON  BG_TYPE=
CASE WHEN TRIM(LG.DESCR)='LG Purchase/Cash+Margin' THEN 'LGPU'
ELSE '' END AND BANK_ID='01' 
LEFT JOIN MAP_CIF CI ON TRIM(GFCUS)||TRIM(GFCLC)=TRIM(REPLACE(CUSTOMER,' ',''));

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C',
FIN_CIF_ID,
'OB' ENTITY_TYPE,
'' BILL_REMIT_EVENT,
BG_TYPE,
'' LIMIT_PREFIX,
'' LIMIT_SUFIX,
CASE WHEN TRIM(LG.DESCR)='LG Purchase/Cash+Margin' THEN 'BGMOD' ELSE '' END EVENT_TYPE,
'LGFN 110% MRGN AMEND_CHGS' EVENT_ID,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'FA' ELSE 'TP' END CHARGE_TYPE,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'KWD' ELSE '' END CHARGE_CCY,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN TO_CHAR(CHARGE) ELSE '' END CHARGE_AMT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN '1' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN '3'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN '6'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN '12'
     ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN 'M'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN 'Q'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN 'H'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN 'Y'
END CHARGE_PCNT_PERIOD,
'1' PART_TRAN,
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN TO_CHAR(MIN_CHARGE) ELSE '' END MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN 'KWD' ELSE '' END MINIMUM_CCY,
'' SCRIPT_NAME,
'trfbgchrgmn001.scr' PTT_SCRIPT_NAME,
''FREE_TEXT_1,''FREE_TEXT_2,''FREE_TEXT_3,''FREE_CODE_1,''FREE_CODE_2,''FREE_CODE_3,
'Y'ENTITY_CRE_FLG,'N'DEL_FLG,SYSDATE RCRE_TIME,'SYSTEM' RCRE_USER_ID, SYSDATE LCHG_TIME,'SYSTEM' LCHG_USER_ID, '01' BANK_ID, ''MIN_PERIOD_PCNT
FROM TF_LGPRICE_LIST LG
INNER JOIN TBAADM.BGP P ON  BG_TYPE=
CASE WHEN TRIM(LG.DESCR)='LG Purchase/Cash+Margin' THEN 'LGPU'
ELSE '' END AND BANK_ID='01' 
LEFT JOIN MAP_CIF CI ON TRIM(GFCUS)||TRIM(GFCLC)=TRIM(REPLACE(CUSTOMER,' ',''));

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C',
FIN_CIF_ID,
'OB' ENTITY_TYPE,
'' BILL_REMIT_EVENT,
BG_TYPE,
'' LIMIT_PREFIX,
'' LIMIT_SUFIX,
CASE WHEN TRIM(LG.DESCR)='LG Purchase/Cash+Margin' THEN 'BGADD' ELSE '' END EVENT_TYPE,
'LGFN 110% MRGN ISS_CHGS' EVENT_ID,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'FA' ELSE 'TP' END CHARGE_TYPE,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'KWD' ELSE '' END CHARGE_CCY,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN TO_CHAR(CHARGE) ELSE '' END CHARGE_AMT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN '1' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN '3'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN '6'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN '12'
     ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN 'M'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN 'Q'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN 'H'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN 'Y'
END CHARGE_PCNT_PERIOD,
'1' PART_TRAN,
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN TO_CHAR(MIN_CHARGE) ELSE '' END MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN 'KWD' ELSE '' END MINIMUM_CCY,
'' SCRIPT_NAME,
'trfbgchrgmn001.scr' PTT_SCRIPT_NAME,
''FREE_TEXT_1,''FREE_TEXT_2,''FREE_TEXT_3,''FREE_CODE_1,''FREE_CODE_2,''FREE_CODE_3,
'Y'ENTITY_CRE_FLG,'N'DEL_FLG,SYSDATE RCRE_TIME,'SYSTEM' RCRE_USER_ID, SYSDATE LCHG_TIME,'SYSTEM' LCHG_USER_ID, '01' BANK_ID, ''MIN_PERIOD_PCNT
FROM TF_LGPRICE_LIST LG
INNER JOIN TBAADM.BGP P ON  BG_TYPE=
CASE WHEN TRIM(LG.DESCR)='LG Purchase/Cash+Margin' THEN 'LGFN'
ELSE '' END AND BANK_ID='01' 
LEFT JOIN MAP_CIF CI ON TRIM(GFCUS)||TRIM(GFCLC)=TRIM(REPLACE(CUSTOMER,' ',''));

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C',
FIN_CIF_ID,
'OB' ENTITY_TYPE,
'' BILL_REMIT_EVENT,
BG_TYPE,
'' LIMIT_PREFIX,
'' LIMIT_SUFIX,
CASE WHEN TRIM(LG.DESCR)='LG Purchase/Cash+Margin' THEN 'BGMOD' ELSE '' END EVENT_TYPE,
'LGFN 110% MRGN AMEND_CHGS' EVENT_ID,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'FA' ELSE 'TP' END CHARGE_TYPE,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'KWD' ELSE '' END CHARGE_CCY,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN TO_CHAR(CHARGE) ELSE '' END CHARGE_AMT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN '1' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN '3'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN '6'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN '12'
     ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN 'M'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN 'Q'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN 'H'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN 'Y'
END CHARGE_PCNT_PERIOD,
'1' PART_TRAN,
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN TO_CHAR(MIN_CHARGE) ELSE '' END MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN 'KWD' ELSE '' END MINIMUM_CCY,
'' SCRIPT_NAME,
'trfbgchrgmn001.scr' PTT_SCRIPT_NAME,
''FREE_TEXT_1,''FREE_TEXT_2,''FREE_TEXT_3,''FREE_CODE_1,''FREE_CODE_2,''FREE_CODE_3,
'Y'ENTITY_CRE_FLG,'N'DEL_FLG,SYSDATE RCRE_TIME,'SYSTEM' RCRE_USER_ID, SYSDATE LCHG_TIME,'SYSTEM' LCHG_USER_ID, '01' BANK_ID, ''MIN_PERIOD_PCNT
FROM TF_LGPRICE_LIST LG
INNER JOIN TBAADM.BGP P ON  BG_TYPE=
CASE WHEN TRIM(LG.DESCR)='LG Purchase/Cash+Margin' THEN 'LGFN'
ELSE '' END AND BANK_ID='01' 
LEFT JOIN MAP_CIF CI ON TRIM(GFCUS)||TRIM(GFCLC)=TRIM(REPLACE(CUSTOMER,' ',''));

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C',
FIN_CIF_ID,
'OB' ENTITY_TYPE,
'' BILL_REMIT_EVENT,
BG_TYPE,
'' LIMIT_PREFIX,
'' LIMIT_SUFIX,
CASE WHEN TRIM(LG.DESCR)='LG Perf/Ret/Adv+Margin' THEN 'BGADD' ELSE '' END EVENT_TYPE,
'LGPR 110% MRGN ISS_CHGS' EVENT_ID,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'FA' ELSE 'TP' END CHARGE_TYPE,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'KWD' ELSE '' END CHARGE_CCY,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN TO_CHAR(CHARGE) ELSE '' END CHARGE_AMT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN '1' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN '3'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN '6'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN '12'
     ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN 'M'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN 'Q'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN 'H'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN 'Y'
END CHARGE_PCNT_PERIOD,
'1' PART_TRAN,
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN TO_CHAR(MIN_CHARGE) ELSE '' END MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN 'KWD' ELSE '' END MINIMUM_CCY,
'' SCRIPT_NAME,
'trfbgchrgmn001.scr' PTT_SCRIPT_NAME,
''FREE_TEXT_1,''FREE_TEXT_2,''FREE_TEXT_3,''FREE_CODE_1,''FREE_CODE_2,''FREE_CODE_3,
'Y'ENTITY_CRE_FLG,'N'DEL_FLG,SYSDATE RCRE_TIME,'SYSTEM' RCRE_USER_ID, SYSDATE LCHG_TIME,'SYSTEM' LCHG_USER_ID, '01' BANK_ID, ''MIN_PERIOD_PCNT
FROM TF_LGPRICE_LIST LG
INNER JOIN TBAADM.BGP P ON  BG_TYPE=
CASE WHEN TRIM(LG.DESCR)='LG Perf/Ret/Adv+Margin' THEN 'LGPR'
ELSE '' END AND BANK_ID='01' 
LEFT JOIN MAP_CIF CI ON TRIM(GFCUS)||TRIM(GFCLC)=TRIM(REPLACE(CUSTOMER,' ',''));

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C',
FIN_CIF_ID,
'OB' ENTITY_TYPE,
'' BILL_REMIT_EVENT,
BG_TYPE,
'' LIMIT_PREFIX,
'' LIMIT_SUFIX,
CASE WHEN TRIM(LG.DESCR)='LG Perf/Ret/Adv+Margin' THEN 'BGMOD' ELSE '' END EVENT_TYPE,
'LGPR 110% MRGN AMEND_CHGS' EVENT_ID,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'FA' ELSE 'TP' END CHARGE_TYPE,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'KWD' ELSE '' END CHARGE_CCY,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN TO_CHAR(CHARGE) ELSE '' END CHARGE_AMT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN '1' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN '3'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN '6'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN '12'
     ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN 'M'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN 'Q'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN 'H'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN 'Y'
END CHARGE_PCNT_PERIOD,
'1' PART_TRAN,
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN TO_CHAR(MIN_CHARGE) ELSE '' END MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN 'KWD' ELSE '' END MINIMUM_CCY,
'' SCRIPT_NAME,
'trfbgchrgmn001.scr' PTT_SCRIPT_NAME,
''FREE_TEXT_1,''FREE_TEXT_2,''FREE_TEXT_3,''FREE_CODE_1,''FREE_CODE_2,''FREE_CODE_3,
'Y'ENTITY_CRE_FLG,'N'DEL_FLG,SYSDATE RCRE_TIME,'SYSTEM' RCRE_USER_ID, SYSDATE LCHG_TIME,'SYSTEM' LCHG_USER_ID, '01' BANK_ID, ''MIN_PERIOD_PCNT
FROM TF_LGPRICE_LIST LG
INNER JOIN TBAADM.BGP P ON  BG_TYPE=
CASE WHEN TRIM(LG.DESCR)='LG Perf/Ret/Adv+Margin' THEN 'LGPR'
ELSE '' END AND BANK_ID='01' 
LEFT JOIN MAP_CIF CI ON TRIM(GFCUS)||TRIM(GFCLC)=TRIM(REPLACE(CUSTOMER,' ',''));

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C',
FIN_CIF_ID,
'OB' ENTITY_TYPE,
'' BILL_REMIT_EVENT,
BG_TYPE,
'' LIMIT_PREFIX,
'' LIMIT_SUFIX,
CASE WHEN TRIM(LG.DESCR)='LG Perf/Ret/Adv+Margin' THEN 'BGADD' ELSE '' END EVENT_TYPE,
'LGRT 110% MRGN ISSUE_CHGS' EVENT_ID,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'FA' ELSE 'TP' END CHARGE_TYPE,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'KWD' ELSE '' END CHARGE_CCY,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN TO_CHAR(CHARGE) ELSE '' END CHARGE_AMT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN '1' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN '3'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN '6'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN '12'
     ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN 'M'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN 'Q'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN 'H'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN 'Y'
END CHARGE_PCNT_PERIOD,
'1' PART_TRAN,
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN TO_CHAR(MIN_CHARGE) ELSE '' END MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN 'KWD' ELSE '' END MINIMUM_CCY,
'' SCRIPT_NAME,
'trfbgchrgmn001.scr' PTT_SCRIPT_NAME,
''FREE_TEXT_1,''FREE_TEXT_2,''FREE_TEXT_3,''FREE_CODE_1,''FREE_CODE_2,''FREE_CODE_3,
'Y'ENTITY_CRE_FLG,'N'DEL_FLG,SYSDATE RCRE_TIME,'SYSTEM' RCRE_USER_ID, SYSDATE LCHG_TIME,'SYSTEM' LCHG_USER_ID, '01' BANK_ID, ''MIN_PERIOD_PCNT
FROM TF_LGPRICE_LIST LG
INNER JOIN TBAADM.BGP P ON  BG_TYPE=
CASE WHEN TRIM(LG.DESCR)='LG Perf/Ret/Adv+Margin' THEN 'LGRT'
ELSE '' END AND BANK_ID='01' 
LEFT JOIN MAP_CIF CI ON TRIM(GFCUS)||TRIM(GFCLC)=TRIM(REPLACE(CUSTOMER,' ',''));

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C',
FIN_CIF_ID,
'OB' ENTITY_TYPE,
'' BILL_REMIT_EVENT,
BG_TYPE,
'' LIMIT_PREFIX,
'' LIMIT_SUFIX,
CASE WHEN TRIM(LG.DESCR)='LG Perf/Ret/Adv+Margin' THEN 'BGMOD' ELSE '' END EVENT_TYPE,
'LGRT 100% MARG AMEND_CHGS' EVENT_ID,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'FA' ELSE 'TP' END CHARGE_TYPE,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'KWD' ELSE '' END CHARGE_CCY,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN TO_CHAR(CHARGE) ELSE '' END CHARGE_AMT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN '1' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN '3'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN '6'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN '12'
     ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN 'M'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN 'Q'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN 'H'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN 'Y'
END CHARGE_PCNT_PERIOD,
'1' PART_TRAN,
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN TO_CHAR(MIN_CHARGE) ELSE '' END MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN 'KWD' ELSE '' END MINIMUM_CCY,
'' SCRIPT_NAME,
'trfbgchrgmn001.scr' PTT_SCRIPT_NAME,
''FREE_TEXT_1,''FREE_TEXT_2,''FREE_TEXT_3,''FREE_CODE_1,''FREE_CODE_2,''FREE_CODE_3,
'Y'ENTITY_CRE_FLG,'N'DEL_FLG,SYSDATE RCRE_TIME,'SYSTEM' RCRE_USER_ID, SYSDATE LCHG_TIME,'SYSTEM' LCHG_USER_ID, '01' BANK_ID, ''MIN_PERIOD_PCNT
FROM TF_LGPRICE_LIST LG
INNER JOIN TBAADM.BGP P ON  BG_TYPE=
CASE WHEN TRIM(LG.DESCR)='LG Perf/Ret/Adv+Margin' THEN 'LGRT'
ELSE '' END AND BANK_ID='01' 
LEFT JOIN MAP_CIF CI ON TRIM(GFCUS)||TRIM(GFCLC)=TRIM(REPLACE(CUSTOMER,' ',''));

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C',
FIN_CIF_ID,
'OB' ENTITY_TYPE,
'' BILL_REMIT_EVENT,
BG_TYPE,
'' LIMIT_PREFIX,
'' LIMIT_SUFIX,
CASE WHEN TRIM(LG.DESCR)='LG Perf/Ret/Adv+Margin' THEN 'BGADD' ELSE '' END EVENT_TYPE,
'LGAP 110% MARGIN_CHGS' EVENT_ID,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'FA' ELSE 'TP' END CHARGE_TYPE,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'KWD' ELSE '' END CHARGE_CCY,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN TO_CHAR(CHARGE) ELSE '' END CHARGE_AMT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN '1' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN '3'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN '6'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN '12'
     ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN 'M'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN 'Q'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN 'H'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN 'Y'
END CHARGE_PCNT_PERIOD,
'1' PART_TRAN,
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN TO_CHAR(MIN_CHARGE) ELSE '' END MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN 'KWD' ELSE '' END MINIMUM_CCY,
'' SCRIPT_NAME,
'trfbgchrgmn001.scr' PTT_SCRIPT_NAME,
''FREE_TEXT_1,''FREE_TEXT_2,''FREE_TEXT_3,''FREE_CODE_1,''FREE_CODE_2,''FREE_CODE_3,
'Y'ENTITY_CRE_FLG,'N'DEL_FLG,SYSDATE RCRE_TIME,'SYSTEM' RCRE_USER_ID, SYSDATE LCHG_TIME,'SYSTEM' LCHG_USER_ID, '01' BANK_ID, ''MIN_PERIOD_PCNT
FROM TF_LGPRICE_LIST LG
INNER JOIN TBAADM.BGP P ON  BG_TYPE=
CASE WHEN TRIM(LG.DESCR)='LG Perf/Ret/Adv+Margin' THEN 'LGAP'
ELSE '' END AND BANK_ID='01' 
LEFT JOIN MAP_CIF CI ON TRIM(GFCUS)||TRIM(GFCLC)=TRIM(REPLACE(CUSTOMER,' ',''));

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C',
FIN_CIF_ID,
'OB' ENTITY_TYPE,
'' BILL_REMIT_EVENT,
BG_TYPE,
'' LIMIT_PREFIX,
'' LIMIT_SUFIX,
CASE WHEN TRIM(LG.DESCR)='LG Perf/Ret/Adv+Margin' THEN 'BGMOD' ELSE '' END EVENT_TYPE,
'LGAP 110% MARG AMEND_CHGS' EVENT_ID,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'FA' ELSE 'TP' END CHARGE_TYPE,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'KWD' ELSE '' END CHARGE_CCY,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN TO_CHAR(CHARGE) ELSE '' END CHARGE_AMT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN '1' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN '3'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN '6'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN '12'
     ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN 'M'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN 'Q'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN 'H'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN 'Y'
END CHARGE_PCNT_PERIOD,
'1' PART_TRAN,
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN TO_CHAR(MIN_CHARGE) ELSE '' END MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN 'KWD' ELSE '' END MINIMUM_CCY,
'' SCRIPT_NAME,
'trfbgchrgmn001.scr' PTT_SCRIPT_NAME,
''FREE_TEXT_1,''FREE_TEXT_2,''FREE_TEXT_3,''FREE_CODE_1,''FREE_CODE_2,''FREE_CODE_3,
'Y'ENTITY_CRE_FLG,'N'DEL_FLG,SYSDATE RCRE_TIME,'SYSTEM' RCRE_USER_ID, SYSDATE LCHG_TIME,'SYSTEM' LCHG_USER_ID, '01' BANK_ID, ''MIN_PERIOD_PCNT
FROM TF_LGPRICE_LIST LG
INNER JOIN TBAADM.BGP P ON  BG_TYPE=
CASE WHEN TRIM(LG.DESCR)='LG Perf/Ret/Adv+Margin' THEN 'LGAP'
ELSE '' END AND BANK_ID='01' 
LEFT JOIN MAP_CIF CI ON TRIM(GFCUS)||TRIM(GFCLC)=TRIM(REPLACE(CUSTOMER,' ',''));

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C',
FIN_CIF_ID,
'OB' ENTITY_TYPE,
'' BILL_REMIT_EVENT,
BG_TYPE,
'' LIMIT_PREFIX,
'' LIMIT_SUFIX,
CASE WHEN TRIM(LG.DESCR)='LG Others+Margin' THEN 'BGADD' ELSE '' END EVENT_TYPE,
'LGOT 110% MRGN ISS_CHGS' EVENT_ID,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'FA' ELSE 'TP' END CHARGE_TYPE,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'KWD' ELSE '' END CHARGE_CCY,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN TO_CHAR(CHARGE) ELSE '' END CHARGE_AMT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN '1' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN '3'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN '6'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN '12'
     ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN 'M'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN 'Q'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN 'H'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN 'Y'
END CHARGE_PCNT_PERIOD,
'1' PART_TRAN,
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN TO_CHAR(MIN_CHARGE) ELSE '' END MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN 'KWD' ELSE '' END MINIMUM_CCY,
'' SCRIPT_NAME,
'trfbgchrgmn001.scr' PTT_SCRIPT_NAME,
''FREE_TEXT_1,''FREE_TEXT_2,''FREE_TEXT_3,''FREE_CODE_1,''FREE_CODE_2,''FREE_CODE_3,
'Y'ENTITY_CRE_FLG,'N'DEL_FLG,SYSDATE RCRE_TIME,'SYSTEM' RCRE_USER_ID, SYSDATE LCHG_TIME,'SYSTEM' LCHG_USER_ID, '01' BANK_ID, ''MIN_PERIOD_PCNT
FROM TF_LGPRICE_LIST LG
INNER JOIN TBAADM.BGP P ON  BG_TYPE=
CASE WHEN TRIM(LG.DESCR)='LG Others+Margin' THEN 'LGOT'
ELSE '' END AND BANK_ID='01' 
LEFT JOIN MAP_CIF CI ON TRIM(GFCUS)||TRIM(GFCLC)=TRIM(REPLACE(CUSTOMER,' ',''));

COMMIT;

INSERT INTO TF_SPL_RATE
SELECT 
'C',
FIN_CIF_ID,
'OB' ENTITY_TYPE,
'' BILL_REMIT_EVENT,
BG_TYPE,
'' LIMIT_PREFIX,
'' LIMIT_SUFIX,
CASE WHEN TRIM(LG.DESCR)='LG Others+Margin' THEN 'BGMOD' ELSE '' END EVENT_TYPE,
'LGOT 110% MRGN AMEND_CHGS' EVENT_ID,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'FA' ELSE 'TP' END CHARGE_TYPE,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN 'KWD' ELSE '' END CHARGE_CCY,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN TO_CHAR(CHARGE) ELSE '' END CHARGE_AMT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(CHARGE) END CHARGE_PCNT,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN '1' 
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN '3'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN '6'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN '12'
     ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='O' THEN '' ELSE TO_CHAR(LG.PERIOD) END,
CASE WHEN SUBSTR(CHARGE_FREQ,1,1)='M' THEN 'M'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Q' THEN 'Q'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='H' THEN 'H'
     WHEN SUBSTR(CHARGE_FREQ,1,1)='Y' THEN 'Y'
END CHARGE_PCNT_PERIOD,
'1' PART_TRAN,
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN TO_CHAR(MIN_CHARGE) ELSE '' END MINIMUM_AMT, 
CASE WHEN TRIM(MIN_CHARGE) IS NOT NULL THEN 'KWD' ELSE '' END MINIMUM_CCY,
'' SCRIPT_NAME,
'trfbgchrgmn001.scr' PTT_SCRIPT_NAME,
''FREE_TEXT_1,''FREE_TEXT_2,''FREE_TEXT_3,''FREE_CODE_1,''FREE_CODE_2,''FREE_CODE_3,
'Y'ENTITY_CRE_FLG,'N'DEL_FLG,SYSDATE RCRE_TIME,'SYSTEM' RCRE_USER_ID, SYSDATE LCHG_TIME,'SYSTEM' LCHG_USER_ID, '01' BANK_ID, ''MIN_PERIOD_PCNT
FROM TF_LGPRICE_LIST LG
INNER JOIN TBAADM.BGP P ON  BG_TYPE=
CASE WHEN TRIM(LG.DESCR)='LG Others+Margin' THEN 'LGOT'
ELSE '' END AND BANK_ID='01' 
LEFT JOIN MAP_CIF CI ON TRIM(GFCUS)||TRIM(GFCLC)=TRIM(REPLACE(CUSTOMER,' ',''));

COMMIT;

